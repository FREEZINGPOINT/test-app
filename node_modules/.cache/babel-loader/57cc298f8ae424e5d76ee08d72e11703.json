{"ast":null,"code":"var _jsxFileName = \"/Users/breakpoint/npm_work/test-app/src/components/SearchUserSelect.js\";\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { Select, Spin } from 'antd';\nimport debounce from 'lodash/debounce';\nimport { FetchDoGet } from '../commons/Utils';\nconst {\n  Option\n} = Select;\n/**\n * 查询用户的搜索框\n */\n\nclass SearchUserSelect extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.fetchUser = value => {\n      console.log('fetching user', value);\n      this.lastFetchId += 1;\n      const fetchId = this.lastFetchId;\n      this.setState({\n        data: [],\n        fetching: true\n      });\n\n      const _this = this;\n\n      FetchDoGet(\"/block/v1/sys_user/selectAllUsers\", function (response) {\n        _this.setState({\n          data: response.data,\n          fetching: false\n        });\n      }, {\n        userName: value\n      });\n    };\n\n    this.handleChange = value => {\n      this.setState({\n        value,\n        data: [],\n        fetching: false\n      });\n      /**\n       * 回掉我们的请求\n       */\n\n      this.props.onChange(value);\n    };\n\n    this.onFocus = () => {\n      this.setState({\n        data: [],\n        fetching: false\n      });\n    };\n\n    this.state = {\n      data: [],\n      value: [],\n      fetching: false,\n      requestUrl: \"/block/v1/sys_user/selectAllUsers\"\n    };\n    this.lastFetchId = 0;\n    this.fetchUser = debounce(this.fetchUser, 800);\n  }\n\n  /**\n   * 初始化我们的数据\n   */\n  componentDidMount() {\n    this.setState({\n      data: [],\n      fetching: true\n    });\n\n    const _this = this;\n\n    FetchDoGet(\"/block/v1/sys_user/selectAllUsers\", function (response) {\n      _this.setState({\n        data: response.data,\n        fetching: false\n      });\n    });\n  }\n\n  render() {\n    const {\n      fetching,\n      data,\n      value\n    } = this.state;\n    let placeHolder = this.props.placeholder;\n\n    if (null == placeHolder || undefined == placeHolder) {\n      placeHolder = \"选择人员\";\n    }\n\n    return React.createElement(Select // mode=\"multiple\"\n    , {\n      labelInValue: true,\n      showSearch: true,\n      value: value,\n      placeholder: placeHolder,\n      onFocus: this.onFocus,\n      notFoundContent: fetching ? React.createElement(Spin, {\n        size: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }) : null,\n      filterOption: false,\n      onSearch: this.fetchUser,\n      onChange: this.handleChange,\n      style: {\n        width: 200,\n        marginRight: \"8px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(Option, {\n      value: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"font\", {\n      color: \"red\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"*\\u6CA1\\u6709,\\u8BF7\\u641C\\u7D22*\")), data.map(item => React.createElement(Option, {\n      key: item.uId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, item.userName)));\n  } //end render\n\n\n} //end class\n\n\nexport default withRouter(SearchUserSelect);","map":{"version":3,"sources":["/Users/breakpoint/npm_work/test-app/src/components/SearchUserSelect.js"],"names":["React","withRouter","Select","Spin","debounce","FetchDoGet","Option","SearchUserSelect","Component","constructor","props","fetchUser","value","console","log","lastFetchId","fetchId","setState","data","fetching","_this","response","userName","handleChange","onChange","onFocus","state","requestUrl","componentDidMount","render","placeHolder","placeholder","undefined","width","marginRight","map","item","uId"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { withRouter } from 'react-router-dom'\nimport { Select, Spin } from 'antd';\nimport debounce from 'lodash/debounce';\nimport { FetchDoGet } from '../commons/Utils';\n\n\nconst { Option } = Select;\n\n/**\n * 查询用户的搜索框\n */\nclass SearchUserSelect extends React.Component{\n\n    constructor(props){\n        super(props)\n        this.state={\n            data: [],\n            value: [],\n            fetching: false,\n            requestUrl:\"/block/v1/sys_user/selectAllUsers\",\n        }\n\n        this.lastFetchId = 0;\n        this.fetchUser = debounce(this.fetchUser, 800);    \n\n    }\n\n    fetchUser = value => {\n        console.log('fetching user', value);\n        this.lastFetchId += 1;\n        const fetchId = this.lastFetchId;\n        this.setState({ data: [], fetching: true });\n\n        const _this=this;\n\n        FetchDoGet(\"/block/v1/sys_user/selectAllUsers\",function(response){\n          _this.setState({ \n            data:response.data,\n            fetching: false \n        });\n        },{userName:value});\n      };\n\n    handleChange = value => {\n        this.setState({\n          value,\n          data: [],\n          fetching: false,\n        });\n        /**\n         * 回掉我们的请求\n         */\n        this.props.onChange(value)\n    };\n\n    onFocus=() =>{\n      this.setState({\n        data: [],\n        fetching: false,\n      });\n    }\n\n    /**\n     * 初始化我们的数据\n     */\n    componentDidMount(){\n      this.setState({ data: [], fetching: true });\n      const _this=this;\n      FetchDoGet(\"/block/v1/sys_user/selectAllUsers\",function(response){\n            _this.setState({ \n                data:response.data,\n                fetching: false \n            });\n        });\n    }\n\n    render(){\n        const { fetching, data, value } = this.state;\n\n        let placeHolder=this.props.placeholder;\n        if(null==placeHolder||undefined==placeHolder){\n          placeHolder=\"选择人员\"\n        }\n        return(\n            <Select\n            // mode=\"multiple\"\n            labelInValue\n            showSearch\n            value={value}\n            placeholder={placeHolder}\n            onFocus={this.onFocus}\n            notFoundContent={fetching ? <Spin size=\"small\" /> : null}\n            filterOption={false}\n            onSearch={this.fetchUser}\n            onChange={this.handleChange}\n            style={{ width: 200,marginRight:\"8px\" }}\n            >\n              <Option value=\"\"><font color=\"red\">*没有,请搜索*</font></Option>\n              {data.map(item => (\n                <Option key={item.uId}>{item.userName}</Option>\n              ))}\n            </Select>\n        )\n\n    }//end render\n\n}//end class\n\nexport default withRouter(SearchUserSelect)"]},"metadata":{},"sourceType":"module"}