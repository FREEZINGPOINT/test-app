{"ast":null,"code":"import React from 'react';\nimport classNames from 'classnames';\nimport { createPortal } from 'react-dom';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nvar PhotoContext = React.createContext({\n  onShow: function () {},\n  addItem: function () {},\n  removeItem: function () {}\n});\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\n\nvar FUNC_ERROR_TEXT = 'Expected a function';\n/** Used as references for various `Number` constants. */\n\nvar NAN = 0 / 0;\n/** `Object#toString` result references. */\n\nvar symbolTag = '[object Symbol]';\n/** Used to match leading and trailing whitespace. */\n\nvar reTrim = /^\\s+|\\s+$/g;\n/** Used to detect bad signed hexadecimal string values. */\n\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n/** Used to detect binary string values. */\n\nvar reIsBinary = /^0b[01]+$/i;\n/** Used to detect octal string values. */\n\nvar reIsOctal = /^0o[0-7]+$/i;\n/** Built-in method references without a dependency on `root`. */\n\nvar freeParseInt = parseInt;\n/** Detect free variable `global` from Node.js. */\n\nvar freeGlobal = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\n/** Detect free variable `self`. */\n\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n/** Used as a reference to the global object. */\n\nvar root = freeGlobal || freeSelf || Function('return this')();\n/** Used for built-in method references. */\n\nvar objectProto = Object.prototype;\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\n\nvar objectToString = objectProto.toString;\n/* Built-in method references for those with the same name as other `lodash` methods. */\n\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\n\nvar now = function () {\n  return root.Date.now();\n};\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\n\n\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n\n  wait = toNumber(wait) || 0;\n\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time; // Start the timer for the trailing edge.\n\n    timerId = setTimeout(timerExpired, wait); // Invoke the leading edge.\n\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime; // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n\n    return lastCallTime === undefined || timeSinceLastCall >= wait || timeSinceLastCall < 0 || maxing && timeSinceLastInvoke >= maxWait;\n  }\n\n  function timerExpired() {\n    var time = now();\n\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    } // Restart the timer.\n\n\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined; // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n\n    return result;\n  }\n\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\n\n\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\n\n\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\n\n\nfunction isSymbol(value) {\n  return typeof value == 'symbol' || isObjectLike(value) && objectToString.call(value) == symbolTag;\n}\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\n\n\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n\n  if (isSymbol(value)) {\n    return NAN;\n  }\n\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? other + '' : other;\n  }\n\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return isBinary || reIsOctal.test(value) ? freeParseInt(value.slice(2), isBinary ? 2 : 8) : reIsBadHex.test(value) ? NAN : +value;\n}\n\nvar lodash_debounce = debounce;\n\nfunction Spinner() {\n  return React.createElement(\"div\", {\n    className: \"PhotoView__Spinner\"\n  }, React.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 32 32\",\n    width: \"36\",\n    height: \"36\",\n    fill: \"white\"\n  }, React.createElement(\"path\", {\n    opacity: \".25\",\n    d: \"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\"\n  }), React.createElement(\"path\", {\n    d: \"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\"\n  })));\n}\n/**\r\n * 获取图片合适的大小\r\n */\n\n\nfunction getSuitableImageSize(naturalWidth, naturalHeight) {\n  var width = 0;\n  var height = 0;\n  var innerWidth = window.innerWidth,\n      innerHeight = window.innerHeight;\n\n  if (naturalWidth < innerWidth && naturalHeight < innerHeight) {\n    width = naturalWidth;\n    height = naturalHeight;\n  } else if (naturalWidth < innerWidth && naturalHeight >= innerHeight) {\n    width = naturalWidth / naturalHeight * innerHeight;\n    height = innerHeight;\n  } else if (naturalWidth >= innerWidth && naturalHeight < innerHeight) {\n    width = innerWidth;\n    height = naturalHeight / naturalWidth * innerWidth;\n  } else if (naturalWidth >= innerWidth && naturalHeight >= innerHeight && naturalWidth / naturalHeight > innerWidth / innerHeight) {\n    width = innerWidth;\n    height = naturalHeight / naturalWidth * innerWidth;\n  } else {\n    width = naturalWidth / naturalHeight * innerHeight;\n    height = innerHeight;\n  }\n\n  return {\n    width: Math.floor(width),\n    height: Math.floor(height)\n  };\n}\n\nfunction useMountedState() {\n  var mountedRef = React.useRef(false);\n  React.useEffect(function () {\n    mountedRef.current = true;\n    return function () {\n      mountedRef.current = false;\n    };\n  });\n  return React.useCallback(function () {\n    return mountedRef.current;\n  }, []);\n}\n\nvar Photo = function (_a) {\n  var src = _a.src,\n      loaded = _a.loaded,\n      broken = _a.broken,\n      width = _a.width,\n      height = _a.height,\n      className = _a.className,\n      onImageLoad = _a.onImageLoad,\n      loadingElement = _a.loadingElement,\n      brokenElement = _a.brokenElement,\n      restProps = __rest(_a, [\"src\", \"loaded\", \"broken\", \"width\", \"height\", \"className\", \"onImageLoad\", \"loadingElement\", \"brokenElement\"]);\n\n  var isMounted = useMountedState();\n\n  function handleImageLoaded(e) {\n    var _a = e.target,\n        naturalWidth = _a.naturalWidth,\n        naturalHeight = _a.naturalHeight;\n\n    if (isMounted()) {\n      onImageLoad(__assign({\n        loaded: true,\n        naturalWidth: naturalWidth,\n        naturalHeight: naturalHeight\n      }, getSuitableImageSize(naturalWidth, naturalHeight)));\n    }\n  }\n\n  function handleImageBroken() {\n    if (isMounted()) {\n      onImageLoad({\n        broken: true\n      });\n    }\n  }\n\n  React.useEffect(function () {\n    var currPhoto = new Image();\n    currPhoto.onload = handleImageLoaded;\n    currPhoto.onerror = handleImageBroken;\n    currPhoto.src = src;\n  }, []);\n\n  if (src && !broken) {\n    if (loaded) {\n      return React.createElement(\"img\", __assign({\n        className: classNames('PhotoView__Photo', className),\n        src: src,\n        width: width,\n        height: height,\n        alt: \"\"\n      }, restProps));\n    }\n\n    return loadingElement || React.createElement(Spinner, null);\n  }\n\n  return brokenElement || null;\n};\n\nPhoto.displayName = 'Photo';\n/**\r\n * throttle\r\n * @param func\r\n * @param wait\r\n */\n\nfunction throttle(func, wait) {\n  return lodash_debounce(func, wait, {\n    leading: true,\n    maxWait: wait,\n    trailing: true\n  });\n}\n/**\r\n * 是否支持触摸设备\r\n */\n\n\nvar isTouchDevice = typeof document !== 'undefined' && 'ontouchstart' in document.documentElement;\n/**\r\n * 从 Touch 事件中获取两个触控中心位置\r\n */\n\nfunction getMultipleTouchPosition(evt) {\n  var _a = evt.touches[0],\n      clientX = _a.clientX,\n      clientY = _a.clientY;\n\n  if (evt.touches.length >= 2) {\n    var _b = evt.touches[1],\n        nextClientX = _b.clientX,\n        nextClientY = _b.clientY;\n    return {\n      clientX: (clientX + nextClientX) / 2,\n      clientY: (clientY + nextClientY) / 2,\n      touchLength: Math.sqrt(Math.pow(nextClientX - clientX, 2) + Math.pow(nextClientY - clientY, 2))\n    };\n  }\n\n  return {\n    clientX: clientX,\n    clientY: clientY,\n    touchLength: 0\n  };\n}\n/**\r\n * 获取移动或缩放之后的中心点\r\n */\n\n\nfunction getPositionOnMoveOrScale(_a) {\n  var x = _a.x,\n      y = _a.y,\n      clientX = _a.clientX,\n      clientY = _a.clientY,\n      _b = _a.offsetX,\n      offsetX = _b === void 0 ? 0 : _b,\n      _c = _a.offsetY,\n      offsetY = _c === void 0 ? 0 : _c,\n      fromScale = _a.fromScale,\n      toScale = _a.toScale;\n  var innerWidth = window.innerWidth,\n      innerHeight = window.innerHeight;\n  var centerClientX = innerWidth / 2;\n  var centerClientY = innerHeight / 2; // 坐标偏移\n\n  var lastPositionX = centerClientX + x;\n  var lastPositionY = centerClientY + y; // 放大偏移量\n\n  var offsetScale = toScale / fromScale; // 偏移位置\n\n  var originX = clientX - (clientX - lastPositionX) * offsetScale - centerClientX;\n  var originY = clientY - (clientY - lastPositionY) * offsetScale - centerClientY;\n  return {\n    x: originX + offsetX,\n    y: originY + offsetY,\n    scale: toScale,\n    lastMoveClientX: clientX,\n    lastMoveClientY: clientY\n  };\n}\n/**\r\n * 最大触摸时间\r\n */\n\n\nvar maxTouchTime = 200;\n/**\r\n * 最大滑动切换图片距离\r\n */\n\nvar maxMoveOffset = 40;\n/**\r\n * 图片的间隔\r\n */\n\nvar horizontalOffset = 20;\n/**\r\n * 最小初始响应距离\r\n */\n\nvar minStartTouchOffset = 10;\n/**\r\n * 默认背景透明度\r\n */\n\nvar defaultOpacity = 1;\n/**\r\n * 最小缩放度\r\n */\n\nvar minScale = 1;\n/**\r\n * 最大缩放度（若图片足够大，则会超出）\r\n */\n\nvar maxScale = 6;\n/**\r\n * 滑动加速度\r\n */\n\nvar slideAcceleration = 0.005;\n/**\r\n * 缩放弹性缓冲\r\n */\n\nvar scaleBuffer = 0.2;\n/**\r\n * 边缘超出状态\r\n */\n\nvar CloseEdgeEnum;\n\n(function (CloseEdgeEnum) {\n  CloseEdgeEnum[CloseEdgeEnum[\"Normal\"] = 0] = \"Normal\";\n  CloseEdgeEnum[CloseEdgeEnum[\"Small\"] = 1] = \"Small\";\n  CloseEdgeEnum[CloseEdgeEnum[\"Before\"] = 2] = \"Before\";\n  CloseEdgeEnum[CloseEdgeEnum[\"After\"] = 3] = \"After\";\n})(CloseEdgeEnum || (CloseEdgeEnum = {}));\n/**\r\n * 边缘触发状态\r\n */\n\n\nvar ReachTypeEnum;\n\n(function (ReachTypeEnum) {\n  ReachTypeEnum[ReachTypeEnum[\"Normal\"] = 0] = \"Normal\";\n  ReachTypeEnum[ReachTypeEnum[\"XReach\"] = 1] = \"XReach\";\n  ReachTypeEnum[ReachTypeEnum[\"YReach\"] = 2] = \"YReach\";\n})(ReachTypeEnum || (ReachTypeEnum = {}));\n/**\r\n * 初始响应状态\r\n */\n\n\nvar TouchStartEnum;\n\n(function (TouchStartEnum) {\n  TouchStartEnum[TouchStartEnum[\"Normal\"] = 0] = \"Normal\";\n  TouchStartEnum[TouchStartEnum[\"X\"] = 1] = \"X\";\n  TouchStartEnum[TouchStartEnum[\"YPush\"] = 2] = \"YPush\";\n  TouchStartEnum[TouchStartEnum[\"YPull\"] = 3] = \"YPull\";\n})(TouchStartEnum || (TouchStartEnum = {}));\n/**\r\n * 动画类型\r\n */\n\n\nvar ShowAnimateEnum;\n\n(function (ShowAnimateEnum) {\n  ShowAnimateEnum[ShowAnimateEnum[\"None\"] = 0] = \"None\";\n  ShowAnimateEnum[ShowAnimateEnum[\"In\"] = 1] = \"In\";\n  ShowAnimateEnum[ShowAnimateEnum[\"Out\"] = 2] = \"Out\";\n})(ShowAnimateEnum || (ShowAnimateEnum = {}));\n/**\r\n * 接触左边或右边边缘\r\n * @param x\r\n * @param scale\r\n * @param width\r\n * @return CloseEdgeEnum\r\n */\n\n\nfunction getClosedHorizontal(x, scale, width) {\n  var innerWidth = window.innerWidth;\n  var currentWidth = width * scale; // 图片超出的宽度\n\n  var outOffsetX = (currentWidth - innerWidth) / 2;\n\n  if (currentWidth <= innerWidth) {\n    return CloseEdgeEnum.Small;\n  } else if (x > 0 && outOffsetX - x <= 0) {\n    return CloseEdgeEnum.Before;\n  } else if (x < 0 && outOffsetX + x <= 0) {\n    return CloseEdgeEnum.After;\n  }\n\n  return CloseEdgeEnum.Normal;\n}\n/**\r\n * 接触上边或下边边缘\r\n * @param y\r\n * @param scale\r\n * @param height\r\n * @return CloseEdgeEnum\r\n */\n\n\nfunction getClosedVertical(y, scale, height) {\n  var innerHeight = window.innerHeight;\n  var currentHeight = height * scale; // 图片超出的高度\n\n  var outOffsetY = (currentHeight - innerHeight) / 2;\n\n  if (currentHeight <= innerHeight) {\n    return CloseEdgeEnum.Small;\n  } else if (y > 0 && outOffsetY - y <= 0) {\n    return CloseEdgeEnum.Before;\n  } else if (y < 0 && outOffsetY + y <= 0) {\n    return CloseEdgeEnum.After;\n  }\n\n  return CloseEdgeEnum.Normal;\n}\n/**\r\n * 获取接触边缘类型\r\n * @param initialTouchState\r\n * @param horizontalCloseEdge\r\n * @param verticalCloseEdge\r\n * @param reachState\r\n */\n\n\nfunction getReachType(_a) {\n  var initialTouchState = _a.initialTouchState,\n      horizontalCloseEdge = _a.horizontalCloseEdge,\n      verticalCloseEdge = _a.verticalCloseEdge,\n      reachState = _a.reachState;\n\n  if (horizontalCloseEdge > 0 && initialTouchState === TouchStartEnum.X || reachState === ReachTypeEnum.XReach) {\n    return ReachTypeEnum.XReach;\n  } else if (verticalCloseEdge > 0 && (initialTouchState === TouchStartEnum.YPull || initialTouchState === TouchStartEnum.YPush) || reachState === ReachTypeEnum.YReach) {\n    return ReachTypeEnum.YReach;\n  }\n\n  return ReachTypeEnum.Normal;\n}\n/**\r\n * 适应到合适的图片偏移量\r\n */\n\n\nfunction slideToPosition(_a) {\n  var x = _a.x,\n      y = _a.y,\n      lastX = _a.lastX,\n      lastY = _a.lastY,\n      width = _a.width,\n      height = _a.height,\n      scale = _a.scale,\n      touchedTime = _a.touchedTime;\n  var moveTime = Date.now() - touchedTime; // 初始速度\n\n  var speedX = (x - lastX) / moveTime;\n  var speedY = (y - lastY) / moveTime; // 停下所消耗时间\n\n  var slideTimeX = Math.abs(speedX / slideAcceleration);\n  var slideTimeY = Math.abs(speedY / slideAcceleration); // 计划滑动位置\n\n  var planX = Math.floor(x + speedX * slideTimeX);\n  var planY = Math.floor(y + speedY * slideTimeY);\n  var currentX = planX;\n  var currentY = planY;\n  var innerWidth = window.innerWidth,\n      innerHeight = window.innerHeight; // 图片超出的长度\n\n  var outOffsetX = (width * scale - innerWidth) / 2;\n  var outOffsetY = (height * scale - innerHeight) / 2;\n  var horizontalCloseEdge = getClosedHorizontal(planX, scale, width);\n  var verticalCloseEdge = getClosedVertical(planY, scale, height); // x\n\n  if (horizontalCloseEdge === CloseEdgeEnum.Small) {\n    currentX = 0;\n  } else if (horizontalCloseEdge === CloseEdgeEnum.Before) {\n    currentX = outOffsetX;\n  } else if (horizontalCloseEdge === CloseEdgeEnum.After) {\n    currentX = -outOffsetX;\n  } // y\n\n\n  if (verticalCloseEdge === CloseEdgeEnum.Small) {\n    currentY = 0;\n  } else if (verticalCloseEdge === CloseEdgeEnum.Before) {\n    currentY = outOffsetY;\n  } else if (verticalCloseEdge === CloseEdgeEnum.After) {\n    currentY = -outOffsetY;\n  } // 时间过长\n\n\n  if (moveTime >= maxTouchTime && horizontalCloseEdge === CloseEdgeEnum.Normal && verticalCloseEdge === CloseEdgeEnum.Normal) {\n    return {\n      x: x,\n      y: y\n    };\n  }\n\n  return {\n    x: currentX,\n    y: currentY\n  };\n}\n/**\r\n * 单击和双击事件处理\r\n * @param singleTap - 单击事件\r\n * @param doubleTap - 双击事件\r\n * @return invokeTap\r\n */\n\n\nfunction withContinuousTap(singleTap, doubleTap) {\n  // 当前连续点击次数\n  var continuousClick = 0;\n  var withDebounceTap = lodash_debounce(function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    continuousClick = 0;\n    singleTap.apply(void 0, args);\n  }, 300);\n  return function invokeTap() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    continuousClick += 1;\n    withDebounceTap.apply(void 0, args); // 双击\n\n    if (continuousClick >= 2) {\n      withDebounceTap.cancel();\n      continuousClick = 0;\n      doubleTap.apply(void 0, args);\n    }\n  };\n}\n\nfunction getAnimateOrigin(originRect, width, height) {\n  if (originRect) {\n    var innerWidth_1 = window.innerWidth,\n        innerHeight_1 = window.innerHeight;\n    var xOrigin = (width - innerWidth_1) / 2 + originRect.clientX;\n    var yOrigin = (height - innerHeight_1) / 2 + originRect.clientY;\n    return xOrigin + \"px \" + yOrigin + \"px\";\n  }\n\n  return undefined;\n}\n\nvar initialState = {\n  // 真实宽度\n  naturalWidth: 1,\n  // 真实高度\n  naturalHeight: 1,\n  // 宽度\n  width: 1,\n  // 高度\n  height: 1,\n  // 加载成功状态\n  loaded: false,\n  // 破碎状态\n  broken: false,\n  // 图片 X 偏移量\n  x: 0,\n  // 图片 y 偏移量\n  y: 0,\n  // 图片缩放程度\n  scale: 1,\n  // 图片处于触摸的状态\n  touched: false,\n  // 背景处于触摸状态\n  maskTouched: false,\n  // 触摸开始时 x 原始坐标\n  clientX: 0,\n  // 触摸开始时 y 原始坐标\n  clientY: 0,\n  // 触摸开始时图片 x 偏移量\n  lastX: 0,\n  // 触摸开始时图片 y 偏移量\n  lastY: 0,\n  // 上一个触摸状态 x 原始坐标\n  lastMoveClientX: 0,\n  // 上一个触摸状态 y 原始坐标\n  lastMoveClientY: 0,\n  // 触摸开始时时间\n  touchedTime: 0,\n  // 多指触控间距\n  lastTouchLength: 0,\n  // 当前边缘触发状态\n  reachState: ReachTypeEnum.Normal\n};\n\nvar PhotoView =\n/** @class */\nfunction (_super) {\n  __extends(PhotoView, _super);\n\n  function PhotoView(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = initialState; // 初始响应状态\n\n    _this.initialTouchState = TouchStartEnum.Normal;\n\n    _this.handleImageLoad = function (imageParams) {\n      _this.setState(imageParams);\n    };\n\n    _this.handleResize = function () {\n      var onPhotoResize = _this.props.onPhotoResize;\n      var _a = _this.state,\n          loaded = _a.loaded,\n          naturalWidth = _a.naturalWidth,\n          naturalHeight = _a.naturalHeight;\n\n      if (loaded) {\n        _this.setState(getSuitableImageSize(naturalWidth, naturalHeight));\n\n        if (onPhotoResize) {\n          onPhotoResize();\n        }\n      }\n    };\n\n    _this.handleStart = function (clientX, clientY, touchLength) {\n      if (touchLength === void 0) {\n        touchLength = 0;\n      }\n\n      _this.setState(function (prevState) {\n        return {\n          touched: true,\n          clientX: clientX,\n          clientY: clientY,\n          lastMoveClientX: clientX,\n          lastMoveClientY: clientY,\n          lastX: prevState.x,\n          lastY: prevState.y,\n          lastTouchLength: touchLength,\n          touchedTime: Date.now()\n        };\n      });\n    };\n\n    _this.onMove = function (newClientX, newClientY, touchLength) {\n      if (touchLength === void 0) {\n        touchLength = 0;\n      }\n\n      var _a = _this.props,\n          onReachMove = _a.onReachMove,\n          isActive = _a.isActive;\n      var _b = _this.state,\n          width = _b.width,\n          height = _b.height,\n          naturalWidth = _b.naturalWidth,\n          x = _b.x,\n          y = _b.y,\n          clientX = _b.clientX,\n          clientY = _b.clientY,\n          lastMoveClientX = _b.lastMoveClientX,\n          lastMoveClientY = _b.lastMoveClientY,\n          lastX = _b.lastX,\n          lastY = _b.lastY,\n          scale = _b.scale,\n          lastTouchLength = _b.lastTouchLength,\n          reachState = _b.reachState,\n          touched = _b.touched,\n          maskTouched = _b.maskTouched;\n\n      if ((touched || maskTouched) && isActive) {\n        // 单指最小缩放下，以初始移动距离来判断意图\n        if (touchLength === 0 && _this.initialTouchState === TouchStartEnum.Normal) {\n          var isStillX = Math.abs(newClientX - clientX) <= minStartTouchOffset;\n          var isStillY = Math.abs(newClientY - clientY) <= minStartTouchOffset; // 初始移动距离不足\n\n          if (isStillX && isStillY) {\n            // 方向记录上次移动距离，以便平滑过渡\n            _this.setState({\n              lastMoveClientX: newClientX,\n              lastMoveClientY: newClientY\n            });\n\n            return;\n          } // 设置响应状态\n\n\n          _this.initialTouchState = !isStillX ? TouchStartEnum.X : newClientY > clientY ? TouchStartEnum.YPull : TouchStartEnum.YPush;\n        }\n\n        var offsetX = newClientX - lastMoveClientX;\n        var offsetY = newClientY - lastMoveClientY; // 边缘触发状态\n\n        var currentReachState = ReachTypeEnum.Normal;\n\n        if (touchLength === 0) {\n          // 边缘超出状态\n          var horizontalCloseEdge = getClosedHorizontal(offsetX + lastX, scale, width);\n          var verticalCloseEdge = getClosedVertical(offsetY + lastY, scale, height); // 边缘触发检测\n\n          currentReachState = getReachType({\n            initialTouchState: _this.initialTouchState,\n            horizontalCloseEdge: horizontalCloseEdge,\n            verticalCloseEdge: verticalCloseEdge,\n            reachState: reachState\n          }); // 接触边缘\n\n          if (currentReachState != ReachTypeEnum.Normal) {\n            onReachMove(currentReachState, newClientX, newClientY, scale);\n          }\n        } // 横向边缘触发、背景触发禁用当前滑动\n\n\n        if (currentReachState === ReachTypeEnum.XReach || maskTouched) {\n          _this.setState({\n            reachState: ReachTypeEnum.XReach\n          });\n        } else {\n          // 目标倍数\n          var endScale = scale + (touchLength - lastTouchLength) / 100 / 2 * scale; // 限制最大倍数和最小倍数\n\n          var toScale = Math.max(Math.min(endScale, Math.max(maxScale, naturalWidth / width)), minScale - scaleBuffer);\n\n          _this.setState(__assign({\n            lastTouchLength: touchLength,\n            reachState: currentReachState\n          }, getPositionOnMoveOrScale({\n            x: x,\n            y: y,\n            clientX: newClientX,\n            clientY: newClientY,\n            offsetX: offsetX,\n            offsetY: offsetY,\n            fromScale: scale,\n            toScale: toScale\n          })));\n        }\n      }\n    };\n\n    _this.onPhotoTap = function (clientX, clientY) {\n      var onPhotoTap = _this.props.onPhotoTap;\n\n      if (onPhotoTap) {\n        onPhotoTap(clientX, clientY);\n      }\n    };\n\n    _this.onDoubleTap = function (clientX, clientY) {\n      var _a = _this.state,\n          width = _a.width,\n          naturalWidth = _a.naturalWidth;\n      var _b = _this.state,\n          x = _b.x,\n          y = _b.y,\n          scale = _b.scale;\n\n      _this.setState(__assign({\n        clientX: clientX,\n        clientY: clientY\n      }, getPositionOnMoveOrScale({\n        x: x,\n        y: y,\n        clientX: clientX,\n        clientY: clientY,\n        fromScale: scale,\n        // 若图片足够大，则放大适应的倍数\n        toScale: scale !== 1 ? 1 : Math.max(2, naturalWidth / width)\n      })));\n    };\n\n    _this.handleWheel = function (e) {\n      var clientX = e.clientX,\n          clientY = e.clientY,\n          deltaY = e.deltaY;\n      var _a = _this.state,\n          width = _a.width,\n          naturalWidth = _a.naturalWidth;\n\n      _this.setState(function (_a) {\n        var x = _a.x,\n            y = _a.y,\n            scale = _a.scale;\n        var endScale = scale - deltaY / 100 / 2; // 限制最大倍数和最小倍数\n\n        var toScale = Math.max(Math.min(endScale, Math.max(maxScale, naturalWidth / width)), minScale);\n        return __assign({\n          clientX: clientX,\n          clientY: clientY\n        }, getPositionOnMoveOrScale({\n          x: x,\n          y: y,\n          clientX: clientX,\n          clientY: clientY,\n          fromScale: scale,\n          toScale: toScale\n        }));\n      });\n    };\n\n    _this.handleMaskStart = function (clientX, clientY) {\n      _this.setState(function (prevState) {\n        return {\n          maskTouched: true,\n          clientX: clientX,\n          clientY: clientY,\n          lastX: prevState.x,\n          lastY: prevState.y\n        };\n      });\n    };\n\n    _this.handleMaskMouseDown = function (e) {\n      _this.handleMaskStart(e.clientX, e.clientY);\n    };\n\n    _this.handleMaskTouchStart = function (e) {\n      var _a = e.touches[0],\n          clientX = _a.clientX,\n          clientY = _a.clientY;\n\n      _this.handleMaskStart(clientX, clientY);\n    };\n\n    _this.handleTouchStart = function (e) {\n      var _a = getMultipleTouchPosition(e),\n          clientX = _a.clientX,\n          clientY = _a.clientY,\n          touchLength = _a.touchLength;\n\n      _this.handleStart(clientX, clientY, touchLength);\n    };\n\n    _this.handleMouseDown = function (e) {\n      e.preventDefault();\n\n      _this.handleStart(e.clientX, e.clientY, 0);\n    };\n\n    _this.handleTouchMove = function (e) {\n      e.preventDefault();\n\n      var _a = getMultipleTouchPosition(e),\n          clientX = _a.clientX,\n          clientY = _a.clientY,\n          touchLength = _a.touchLength;\n\n      _this.onMove(clientX, clientY, touchLength);\n    };\n\n    _this.handleMouseMove = function (e) {\n      e.preventDefault();\n\n      _this.onMove(e.clientX, e.clientY);\n    };\n\n    _this.handleUp = function (newClientX, newClientY) {\n      // 重置响应状态\n      _this.initialTouchState = TouchStartEnum.Normal;\n      var _a = _this.props,\n          onReachUp = _a.onReachUp,\n          onPhotoTap = _a.onPhotoTap,\n          onMaskTap = _a.onMaskTap,\n          isActive = _a.isActive;\n      var _b = _this.state,\n          width = _b.width,\n          height = _b.height,\n          naturalWidth = _b.naturalWidth,\n          x = _b.x,\n          y = _b.y,\n          lastX = _b.lastX,\n          lastY = _b.lastY,\n          scale = _b.scale,\n          touchedTime = _b.touchedTime,\n          clientX = _b.clientX,\n          clientY = _b.clientY,\n          touched = _b.touched,\n          maskTouched = _b.maskTouched;\n\n      if ((touched || maskTouched) && isActive) {\n        var hasMove_1 = clientX !== newClientX || clientY !== newClientY;\n\n        _this.setState(__assign({\n          touched: false,\n          maskTouched: false,\n          // 限制缩放\n          scale: Math.max(Math.min(scale, Math.max(maxScale, naturalWidth / width)), minScale),\n          reachState: ReachTypeEnum.Normal\n        }, hasMove_1 ? slideToPosition({\n          x: x,\n          y: y,\n          lastX: lastX,\n          lastY: lastY,\n          width: width,\n          height: height,\n          scale: scale,\n          touchedTime: touchedTime\n        }) : {\n          x: x,\n          y: y\n        }), function () {\n          if (onReachUp) {\n            onReachUp(newClientX, newClientY);\n          } // 触发 Tap 事件\n\n\n          if (!hasMove_1) {\n            if (touched && onPhotoTap) {\n              _this.handlePhotoTap(newClientX, newClientY);\n            } else if (maskTouched && onMaskTap) {\n              onMaskTap(newClientX, newClientY);\n            }\n          }\n        });\n      }\n    };\n\n    _this.handleTouchEnd = function (e) {\n      var _a = e.changedTouches[0],\n          clientX = _a.clientX,\n          clientY = _a.clientY;\n\n      _this.handleUp(clientX, clientY);\n    };\n\n    _this.handleMouseUp = function (e) {\n      var clientX = e.clientX,\n          clientY = e.clientY;\n\n      _this.handleUp(clientX, clientY);\n    };\n\n    _this.onMove = throttle(_this.onMove, 8);\n    _this.handleResize = throttle(_this.handleResize, 8); // 单击与双击事件处理\n\n    _this.handlePhotoTap = withContinuousTap(_this.onPhotoTap, _this.onDoubleTap);\n    return _this;\n  }\n\n  PhotoView.prototype.componentDidMount = function () {\n    if (isTouchDevice) {\n      window.addEventListener('touchmove', this.handleTouchMove, {\n        passive: false\n      });\n      window.addEventListener('touchend', this.handleTouchEnd, {\n        passive: false\n      });\n    } else {\n      window.addEventListener('mousemove', this.handleMouseMove);\n      window.addEventListener('mouseup', this.handleMouseUp);\n    }\n\n    window.addEventListener('resize', this.handleResize);\n  };\n\n  PhotoView.prototype.componentWillUnmount = function () {\n    if (isTouchDevice) {\n      window.removeEventListener('touchmove', this.handleTouchMove);\n      window.removeEventListener('touchend', this.handleTouchEnd);\n    } else {\n      window.removeEventListener('mousemove', this.handleMouseMove);\n      window.removeEventListener('mouseup', this.handleMouseUp);\n    }\n\n    window.removeEventListener('resize', this.handleResize);\n  };\n\n  PhotoView.prototype.render = function () {\n    var _a = this.props,\n        src = _a.src,\n        viewClassName = _a.viewClassName,\n        className = _a.className,\n        style = _a.style,\n        loadingElement = _a.loadingElement,\n        brokenElement = _a.brokenElement,\n        isActive = _a.isActive,\n        showAnimateType = _a.showAnimateType,\n        originRect = _a.originRect;\n    var _b = this.state,\n        width = _b.width,\n        height = _b.height,\n        loaded = _b.loaded,\n        x = _b.x,\n        y = _b.y,\n        scale = _b.scale,\n        touched = _b.touched,\n        broken = _b.broken;\n    var transform = \"translate3d(\" + x + \"px, \" + y + \"px, 0) scale(\" + scale + \")\";\n    return React.createElement(\"div\", {\n      className: classNames('PhotoView__PhotoWrap', viewClassName),\n      style: style\n    }, React.createElement(\"div\", {\n      className: \"PhotoView__PhotoMask\",\n      onMouseDown: !isTouchDevice && isActive ? this.handleMaskMouseDown : undefined,\n      onTouchStart: isTouchDevice && isActive ? this.handleMaskTouchStart : undefined\n    }), React.createElement(\"div\", {\n      className: classNames({\n        PhotoView__animateIn: loaded && showAnimateType === ShowAnimateEnum.In,\n        PhotoView__animateOut: loaded && showAnimateType === ShowAnimateEnum.Out\n      }),\n      style: {\n        transformOrigin: loaded ? getAnimateOrigin(originRect, width, height) : undefined\n      }\n    }, React.createElement(Photo, {\n      className: className,\n      src: src,\n      width: width,\n      height: height,\n      loaded: loaded,\n      broken: broken,\n      onMouseDown: isTouchDevice ? undefined : this.handleMouseDown,\n      onTouchStart: isTouchDevice ? this.handleTouchStart : undefined,\n      onWheel: this.handleWheel,\n      style: {\n        WebkitTransform: transform,\n        transform: transform,\n        transition: touched ? undefined : 'transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1)'\n      },\n      onImageLoad: this.handleImageLoad,\n      loadingElement: loadingElement,\n      brokenElement: brokenElement\n    })));\n  };\n\n  PhotoView.displayName = 'PhotoView';\n  return PhotoView;\n}(React.Component);\n\nvar SlideWrap = function (_a) {\n  var className = _a.className,\n      children = _a.children,\n      restProps = __rest(_a, [\"className\", \"children\"]);\n\n  var dialogNode = React.useMemo(function () {\n    // 容器\n    var dialogNode = document.createElement('section');\n    document.body.appendChild(dialogNode);\n    return dialogNode;\n  }, []);\n  var originalOverflowCallback = React.useRef('');\n  React.useEffect(function () {\n    var style = document.body.style;\n    originalOverflowCallback.current = style.overflow;\n    style.overflow = 'hidden';\n    return function () {\n      var style = document.body.style;\n      style.overflow = originalOverflowCallback.current; // 清除容器\n\n      document.body.removeChild(dialogNode);\n    };\n  }, []);\n  return createPortal(React.createElement(\"div\", __assign({\n    className: classNames('PhotoView-SlideWrap', className)\n  }, restProps), children), dialogNode);\n};\n\nSlideWrap.displayName = 'SlideWrap';\n\nfunction VisibleAnimationHandle(_a) {\n  var visible = _a.visible,\n      currentImage = _a.currentImage,\n      children = _a.children;\n\n  var _b = React.useState(visible),\n      photoVisible = _b[0],\n      updatePhotoVisible = _b[1];\n\n  var _c = React.useState(ShowAnimateEnum.None),\n      showAnimateType = _c[0],\n      updateAnimateStatus = _c[1];\n\n  var _d = React.useState(),\n      originRect = _d[0],\n      updateOriginRect = _d[1];\n\n  function onShowAnimateEnd() {\n    updateAnimateStatus(ShowAnimateEnum.None); // Close\n\n    if (showAnimateType === ShowAnimateEnum.Out) {\n      updatePhotoVisible(false);\n    }\n  }\n\n  React.useEffect(function () {\n    if (!currentImage) {\n      return;\n    }\n\n    var originRef = currentImage.originRef;\n\n    if (originRef && originRef.nodeType === 1) {\n      // 获取触发时节点位置\n      var _a = originRef.getBoundingClientRect(),\n          top_1 = _a.top,\n          left = _a.left,\n          width = _a.width,\n          height = _a.height;\n\n      updateOriginRect({\n        clientX: left + width / 2,\n        clientY: top_1 + height / 2\n      });\n    } else if (originRect && !originRef) {\n      updateOriginRect(undefined);\n    }\n\n    if (visible) {\n      updateAnimateStatus(ShowAnimateEnum.In);\n      updatePhotoVisible(true);\n    } else {\n      updateAnimateStatus(ShowAnimateEnum.Out);\n    }\n  }, [visible]);\n  return children({\n    photoVisible: photoVisible,\n    showAnimateType: showAnimateType,\n    originRect: originRect,\n    onShowAnimateEnd: onShowAnimateEnd\n  });\n}\n\nfunction CloseSVG(props) {\n  return React.createElement(\"svg\", __assign({\n    version: \"1.1\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"44\",\n    height: \"44\",\n    viewBox: \"0 0 768 768\"\n  }, props), React.createElement(\"path\", {\n    fill: \"#FFF\",\n    d: \"M607.5 205.5l-178.5 178.5 178.5 178.5-45 45-178.5-178.5-178.5 178.5-45-45 178.5-178.5-178.5-178.5 45-45 178.5 178.5 178.5-178.5z\"\n  }));\n}\n\nfunction ArrowLeft(props) {\n  return React.createElement(\"svg\", __assign({\n    version: \"1.1\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"44\",\n    height: \"44\",\n    viewBox: \"0 0 768 768\"\n  }, props), React.createElement(\"path\", {\n    d: \"M640.5 352.5v63h-390l178.5 180-45 45-256.5-256.5 256.5-256.5 45 45-178.5 180h390z\"\n  }));\n}\n\nfunction ArrowRight(props) {\n  return React.createElement(\"svg\", __assign({\n    version: \"1.1\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"44\",\n    height: \"44\",\n    viewBox: \"0 0 768 768\"\n  }, props), React.createElement(\"path\", {\n    d: \"M384 127.5l256.5 256.5-256.5 256.5-45-45 178.5-180h-390v-63h390l-178.5-180z\"\n  }));\n}\n\nvar PhotoSlider =\n/** @class */\nfunction (_super) {\n  __extends(PhotoSlider, _super);\n\n  function PhotoSlider(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.handleClose = function () {\n      var onClose = _this.props.onClose;\n      var backdropOpacity = _this.state.backdropOpacity;\n      onClose();\n\n      _this.setState({\n        overlayVisible: true,\n        // 记录当前关闭时的透明度\n        lastBackdropOpacity: backdropOpacity\n      });\n    };\n\n    _this.handlePhotoTap = function () {\n      var photoClosable = _this.props.photoClosable;\n\n      if (photoClosable) {\n        _this.handleClose();\n      } else {\n        _this.setState(function (prevState) {\n          return {\n            overlayVisible: !prevState.overlayVisible\n          };\n        });\n      }\n    };\n\n    _this.handlePhotoMaskTap = function () {\n      var maskClosable = _this.props.maskClosable;\n\n      if (maskClosable) {\n        _this.handleClose();\n      }\n    };\n\n    _this.handleResize = function () {\n      var innerWidth = window.innerWidth;\n\n      _this.setState(function (_a) {\n        var photoIndex = _a.photoIndex;\n        return {\n          translateX: -(innerWidth + horizontalOffset) * photoIndex,\n          lastClientX: undefined,\n          lastClientY: undefined\n        };\n      });\n    };\n\n    _this.handleKeyDown = function (evt) {\n      var visible = _this.props.visible;\n\n      if (visible) {\n        switch (evt.key) {\n          case 'ArrowLeft':\n            _this.handlePrevious(false);\n\n            break;\n\n          case 'ArrowRight':\n            _this.handleNext(false);\n\n            break;\n\n          case 'Escape':\n            _this.handleClose();\n\n            break;\n        }\n      }\n    };\n\n    _this.handleReachVerticalMove = function (clientY, scale) {\n      _this.setState(function (_a) {\n        var lastClientY = _a.lastClientY,\n            backdropOpacity = _a.backdropOpacity;\n\n        if (lastClientY === undefined) {\n          return {\n            touched: true,\n            lastClientY: clientY,\n            backdropOpacity: backdropOpacity,\n            canPullClose: true\n          };\n        }\n\n        var offsetClientY = Math.abs(clientY - lastClientY);\n        var opacity = Math.max(Math.min(defaultOpacity, defaultOpacity - offsetClientY / 100 / 2), 0);\n        return {\n          touched: true,\n          lastClientY: lastClientY,\n          backdropOpacity: scale === 1 ? opacity : defaultOpacity,\n          canPullClose: scale === 1\n        };\n      });\n    };\n\n    _this.handleReachHorizontalMove = function (clientX) {\n      var innerWidth = window.innerWidth;\n      var images = _this.props.images;\n\n      _this.setState(function (_a) {\n        var lastClientX = _a.lastClientX,\n            translateX = _a.translateX,\n            photoIndex = _a.photoIndex;\n\n        if (lastClientX === undefined) {\n          return {\n            touched: true,\n            lastClientX: clientX,\n            translateX: translateX,\n            shouldTransition: true\n          };\n        }\n\n        var originOffsetClientX = clientX - lastClientX;\n        var offsetClientX = originOffsetClientX; // 第一张和最后一张超出距离减半\n\n        if (photoIndex === 0 && originOffsetClientX > 0 || photoIndex === images.length - 1 && originOffsetClientX < 0) {\n          offsetClientX = originOffsetClientX / 2;\n        }\n\n        return {\n          touched: true,\n          lastClientX: lastClientX,\n          translateX: -(innerWidth + horizontalOffset) * photoIndex + offsetClientX,\n          shouldTransition: true\n        };\n      });\n    };\n\n    _this.handleIndexChange = function (photoIndex, shouldTransition) {\n      if (shouldTransition === void 0) {\n        shouldTransition = true;\n      }\n\n      var singlePageWidth = window.innerWidth + horizontalOffset;\n      var translateX = -singlePageWidth * photoIndex;\n\n      _this.setState({\n        touched: false,\n        lastClientX: undefined,\n        lastClientY: undefined,\n        translateX: translateX,\n        photoIndex: photoIndex,\n        shouldTransition: shouldTransition\n      });\n\n      var onIndexChange = _this.props.onIndexChange;\n\n      if (onIndexChange) {\n        onIndexChange(photoIndex);\n      }\n    };\n\n    _this.handlePrevious = function (shouldTransition) {\n      var photoIndex = _this.state.photoIndex;\n\n      if (photoIndex > 0) {\n        _this.handleIndexChange(photoIndex - 1, shouldTransition);\n      }\n    };\n\n    _this.handleNext = function (shouldTransition) {\n      var images = _this.props.images;\n      var photoIndex = _this.state.photoIndex;\n\n      if (photoIndex < images.length - 1) {\n        _this.handleIndexChange(photoIndex + 1, shouldTransition);\n      }\n    };\n\n    _this.handleReachMove = function (reachState, clientX, clientY, scale) {\n      if (reachState === ReachTypeEnum.XReach) {\n        _this.handleReachHorizontalMove(clientX);\n      } else if (reachState === ReachTypeEnum.YReach) {\n        _this.handleReachVerticalMove(clientY, scale);\n      }\n    };\n\n    _this.handleReachUp = function (clientX, clientY) {\n      var images = _this.props.images;\n      var _a = _this.state,\n          _b = _a.lastClientX,\n          lastClientX = _b === void 0 ? clientX : _b,\n          _c = _a.lastClientY,\n          lastClientY = _c === void 0 ? clientY : _c,\n          photoIndex = _a.photoIndex,\n          overlayVisible = _a.overlayVisible,\n          canPullClose = _a.canPullClose;\n      var offsetClientX = clientX - lastClientX;\n      var offsetClientY = clientY - lastClientY;\n      var willClose = false; // 下一张\n\n      if (offsetClientX < -maxMoveOffset && photoIndex < images.length - 1) {\n        _this.handleIndexChange(photoIndex + 1);\n\n        return;\n      } // 上一张\n\n\n      if (offsetClientX > maxMoveOffset && photoIndex > 0) {\n        _this.handleIndexChange(photoIndex - 1);\n\n        return;\n      }\n\n      var singlePageWidth = window.innerWidth + horizontalOffset; // 当前偏移\n\n      var currentTranslateX = -singlePageWidth * photoIndex;\n      var currentPhotoIndex = photoIndex;\n\n      if (Math.abs(offsetClientY) > window.innerHeight * 0.14 && canPullClose) {\n        willClose = true;\n\n        _this.handleClose();\n      }\n\n      _this.setState({\n        touched: false,\n        translateX: currentTranslateX,\n        photoIndex: currentPhotoIndex,\n        lastClientX: undefined,\n        lastClientY: undefined,\n        backdropOpacity: defaultOpacity,\n        overlayVisible: willClose ? true : overlayVisible\n      });\n    };\n\n    _this.state = {\n      translateX: 0,\n      photoIndex: 0,\n      touched: false,\n      shouldTransition: true,\n      lastClientX: undefined,\n      lastClientY: undefined,\n      backdropOpacity: defaultOpacity,\n      lastBackdropOpacity: defaultOpacity,\n      overlayVisible: true,\n      canPullClose: true\n    };\n    _this.handleResize = lodash_debounce(_this.handleResize, 32);\n    return _this;\n  }\n\n  PhotoSlider.getDerivedStateFromProps = function (nextProps, prevState) {\n    if (nextProps.index !== undefined && nextProps.index !== prevState.photoIndex) {\n      return {\n        photoIndex: nextProps.index,\n        translateX: -(window.innerWidth + horizontalOffset) * nextProps.index\n      };\n    }\n\n    return null;\n  };\n\n  PhotoSlider.prototype.componentDidMount = function () {\n    var _a = this.props.index,\n        index = _a === void 0 ? 0 : _a;\n    this.setState({\n      translateX: index * -(window.innerWidth + horizontalOffset),\n      photoIndex: index\n    });\n    window.addEventListener('keydown', this.handleKeyDown);\n  };\n\n  PhotoSlider.prototype.componentWillUnmount = function () {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  };\n\n  PhotoSlider.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.props,\n        images = _a.images,\n        visible = _a.visible,\n        className = _a.className,\n        maskClassName = _a.maskClassName,\n        viewClassName = _a.viewClassName,\n        imageClassName = _a.imageClassName,\n        bannerVisible = _a.bannerVisible,\n        introVisible = _a.introVisible,\n        overlayRender = _a.overlayRender,\n        loadingElement = _a.loadingElement,\n        brokenElement = _a.brokenElement;\n    var _b = this.state,\n        translateX = _b.translateX,\n        touched = _b.touched,\n        photoIndex = _b.photoIndex,\n        backdropOpacity = _b.backdropOpacity,\n        lastBackdropOpacity = _b.lastBackdropOpacity,\n        overlayVisible = _b.overlayVisible,\n        shouldTransition = _b.shouldTransition;\n    var imageLength = images.length;\n    var currentImage = images.length ? images[photoIndex] : undefined;\n    var transform = \"translate3d(\" + translateX + \"px, 0px, 0)\"; // Overlay\n\n    var overlayIntro = currentImage && currentImage.intro;\n    return React.createElement(VisibleAnimationHandle, {\n      visible: visible,\n      currentImage: currentImage\n    }, function (_a) {\n      var photoVisible = _a.photoVisible,\n          showAnimateType = _a.showAnimateType,\n          originRect = _a.originRect,\n          onShowAnimateEnd = _a.onShowAnimateEnd;\n\n      if (photoVisible) {\n        var innerWidth_1 = window.innerWidth;\n        var currentOverlayVisible = overlayVisible && showAnimateType === ShowAnimateEnum.None; // 关闭过程中使用下拉保存的透明度\n\n        var currentOpacity = visible ? backdropOpacity : lastBackdropOpacity;\n        return React.createElement(SlideWrap, {\n          className: classNames({\n            'PhotoView-PhotoSlider__clean': !currentOverlayVisible\n          }, className)\n        }, React.createElement(\"div\", {\n          className: classNames('PhotoView-PhotoSlider__Backdrop', maskClassName, {\n            'PhotoView-PhotoSlider__fadeIn': showAnimateType === ShowAnimateEnum.In,\n            'PhotoView-PhotoSlider__fadeOut': showAnimateType === ShowAnimateEnum.Out\n          }),\n          style: {\n            background: \"rgba(0, 0, 0, \" + currentOpacity + \")\"\n          },\n          onAnimationEnd: onShowAnimateEnd\n        }), bannerVisible && React.createElement(\"div\", {\n          className: \"PhotoView-PhotoSlider__BannerWrap\"\n        }, React.createElement(\"div\", {\n          className: \"PhotoView-PhotoSlider__Counter\"\n        }, photoIndex + 1, \" / \", imageLength), React.createElement(\"div\", {\n          className: \"PhotoView-PhotoSlider__BannerRight\"\n        }, React.createElement(CloseSVG, {\n          className: \"PhotoView-PhotoSlider__Close\",\n          onTouchEnd: isTouchDevice ? _this.handleClose : undefined,\n          onClick: isTouchDevice ? undefined : _this.handleClose\n        }))), images.slice( // 加载相邻三张\n        Math.max(photoIndex - 1, 0), Math.min(photoIndex + 2, imageLength + 1)).map(function (item, index) {\n          // 截取之前的索引位置\n          var realIndex = photoIndex === 0 ? photoIndex + index : photoIndex - 1 + index;\n          return React.createElement(PhotoView, {\n            key: item.key || realIndex,\n            src: item.src,\n            onReachMove: _this.handleReachMove,\n            onReachUp: _this.handleReachUp,\n            onPhotoTap: _this.handlePhotoTap,\n            onMaskTap: _this.handlePhotoMaskTap,\n            viewClassName: viewClassName,\n            className: imageClassName,\n            style: {\n              left: (innerWidth_1 + horizontalOffset) * realIndex + \"px\",\n              WebkitTransform: transform,\n              transform: transform,\n              transition: touched || !shouldTransition ? undefined : 'transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1)'\n            },\n            loadingElement: loadingElement,\n            brokenElement: brokenElement,\n            onPhotoResize: _this.handleResize,\n            isActive: photoIndex === realIndex,\n            showAnimateType: showAnimateType,\n            originRect: originRect\n          });\n        }), !isTouchDevice && bannerVisible && React.createElement(React.Fragment, null, photoIndex !== 0 && React.createElement(\"div\", {\n          className: \"PhotoView-PhotoSlider__ArrowLeft\",\n          onClick: function () {\n            return _this.handlePrevious(false);\n          }\n        }, React.createElement(ArrowLeft, null)), photoIndex + 1 < imageLength && React.createElement(\"div\", {\n          className: \"PhotoView-PhotoSlider__ArrowRight\",\n          onClick: function () {\n            return _this.handleNext(false);\n          }\n        }, React.createElement(ArrowRight, null))), Boolean(introVisible && overlayIntro) && React.createElement(\"div\", {\n          className: \"PhotoView-PhotoSlider__FooterWrap\"\n        }, overlayIntro), overlayRender && overlayRender({\n          images: images,\n          index: photoIndex,\n          visible: visible,\n          onClose: _this.handleClose,\n          onIndexChange: _this.handleIndexChange,\n          overlayVisible: currentOverlayVisible\n        }));\n      }\n\n      return null;\n    });\n  };\n\n  PhotoSlider.displayName = 'PhotoSlider';\n  PhotoSlider.defaultProps = {\n    maskClosable: true,\n    photoClosable: false,\n    bannerVisible: true,\n    introVisible: true\n  };\n  return PhotoSlider;\n}(React.Component);\n\nvar PhotoProvider =\n/** @class */\nfunction (_super) {\n  __extends(PhotoProvider, _super);\n\n  function PhotoProvider(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.handleAddItem = function (imageItem) {\n      _this.setState(function (prev) {\n        return {\n          images: prev.images.concat(imageItem)\n        };\n      });\n    };\n\n    _this.handleRemoveItem = function (key) {\n      _this.setState(function (_a) {\n        var images = _a.images,\n            index = _a.index;\n        var nextImages = images.filter(function (item) {\n          return item.key !== key;\n        });\n        var nextEndIndex = nextImages.length - 1;\n        return {\n          images: nextImages,\n          index: Math.min(nextEndIndex, index)\n        };\n      });\n    };\n\n    _this.handleShow = function (key) {\n      var images = _this.state.images;\n\n      _this.setState({\n        visible: true,\n        index: images.findIndex(function (item) {\n          return item.key === key;\n        })\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        visible: false\n      });\n    };\n\n    _this.handleIndexChange = function (index) {\n      _this.setState({\n        index: index\n      });\n    };\n\n    _this.state = {\n      images: [],\n      visible: false,\n      index: 0,\n      addItem: _this.handleAddItem,\n      removeItem: _this.handleRemoveItem,\n      onShow: _this.handleShow\n    };\n    return _this;\n  }\n\n  PhotoProvider.prototype.render = function () {\n    var _a = this.props,\n        children = _a.children,\n        restProps = __rest(_a, [\"children\"]);\n\n    var _b = this.state,\n        images = _b.images,\n        visible = _b.visible,\n        index = _b.index;\n    return React.createElement(PhotoContext.Provider, {\n      value: this.state\n    }, children, React.createElement(PhotoSlider, __assign({\n      images: images,\n      visible: visible,\n      index: index,\n      onIndexChange: this.handleIndexChange,\n      onClose: this.handleClose\n    }, restProps)));\n  };\n\n  return PhotoProvider;\n}(React.Component);\n/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\n\n\nvar INFINITY = 1 / 0;\n/** `Object#toString` result references. */\n\nvar symbolTag$1 = '[object Symbol]';\n/** Detect free variable `global` from Node.js. */\n\nvar freeGlobal$1 = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\n/** Detect free variable `self`. */\n\nvar freeSelf$1 = typeof self == 'object' && self && self.Object === Object && self;\n/** Used as a reference to the global object. */\n\nvar root$1 = freeGlobal$1 || freeSelf$1 || Function('return this')();\n/** Used for built-in method references. */\n\nvar objectProto$1 = Object.prototype;\n/** Used to generate unique IDs. */\n\nvar idCounter = 0;\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\n\nvar objectToString$1 = objectProto$1.toString;\n/** Built-in value references. */\n\nvar Symbol = root$1.Symbol;\n/** Used to convert symbols to primitives and strings. */\n\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\n\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n\n  if (isSymbol$1(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n\n  var result = value + '';\n  return result == '0' && 1 / value == -INFINITY ? '-0' : result;\n}\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\n\n\nfunction isObjectLike$1(value) {\n  return !!value && typeof value == 'object';\n}\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\n\n\nfunction isSymbol$1(value) {\n  return typeof value == 'symbol' || isObjectLike$1(value) && objectToString$1.call(value) == symbolTag$1;\n}\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\n\n\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n/**\n * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {string} [prefix=''] The value to prefix the ID with.\n * @returns {string} Returns the unique ID.\n * @example\n *\n * _.uniqueId('contact_');\n * // => 'contact_104'\n *\n * _.uniqueId();\n * // => '105'\n */\n\n\nfunction uniqueId(prefix) {\n  var id = ++idCounter;\n  return toString(prefix) + id;\n}\n\nvar lodash_uniqueid = uniqueId;\n\nvar PhotoConsumer = function (_a) {\n  var src = _a.src,\n      intro = _a.intro,\n      children = _a.children;\n  var photoContext = React.useContext(PhotoContext);\n  var key = React.useMemo(function () {\n    return lodash_uniqueid();\n  }, []);\n\n  var _b = React.useState({\n    clientX: undefined,\n    clientY: undefined\n  }),\n      position = _b[0],\n      updatePosition = _b[1];\n\n  var photoTriggerRef = React.useRef(null);\n  React.useEffect(function () {\n    photoContext.addItem({\n      key: key,\n      src: src,\n      originRef: photoTriggerRef.current,\n      intro: intro\n    });\n    return function () {\n      photoContext.removeItem(key);\n    };\n  }, []);\n\n  function handleTouchStart(e) {\n    var _a = e.touches[0],\n        clientX = _a.clientX,\n        clientY = _a.clientY;\n    updatePosition({\n      clientX: clientX,\n      clientY: clientY\n    });\n\n    if (children) {\n      var onTouchStart = children.props.onTouchStart;\n\n      if (onTouchStart) {\n        onTouchStart(e);\n      }\n    }\n  }\n\n  function handleTouchEnd(e) {\n    var _a = e.changedTouches[0],\n        clientX = _a.clientX,\n        clientY = _a.clientY;\n\n    if (position.clientX === clientX && position.clientY === clientY) {\n      photoContext.onShow(key);\n    }\n\n    if (children) {\n      var onTouchEnd = children.props.onTouchEnd;\n\n      if (onTouchEnd) {\n        onTouchEnd(e);\n      }\n    }\n  }\n\n  function handleClick(e) {\n    photoContext.onShow(key);\n\n    if (children) {\n      var onClick = children.props.onClick;\n\n      if (onClick) {\n        onClick(e);\n      }\n    }\n  }\n\n  if (children) {\n    return React.Children.only(React.cloneElement(children, isTouchDevice ? {\n      onTouchStart: handleTouchStart,\n      onTouchEnd: handleTouchEnd,\n      ref: photoTriggerRef\n    } : {\n      onClick: handleClick,\n      ref: photoTriggerRef\n    }));\n  }\n\n  return null;\n};\n\nexport { PhotoConsumer, PhotoProvider, PhotoSlider };","map":{"version":3,"sources":["../node_modules/tslib/tslib.es6.js","../src/photo-context.ts","../node_modules/lodash.debounce/index.js","../src/components/Spinner.tsx","../src/utils/getSuitableImageSize.ts","../src/utils/useMountedState.ts","../src/Photo.tsx","../src/utils/throttle.ts","../src/utils/isTouchDevice.ts","../src/utils/getMultipleTouchPosition.ts","../src/utils/getPositionOnMoveOrScale.ts","../src/variables.ts","../src/types.ts","../src/utils/getCloseEdge.ts","../src/utils/slideToPosition.ts","../src/utils/withContinuousTap.ts","../src/utils/getAnimateOrigin.ts","../src/PhotoView.tsx","../src/components/SlideWrap.tsx","../src/components/VisibleAnimationHandle.tsx","../src/components/CloseSVG.tsx","../src/components/ArrowLeft.tsx","../src/components/ArrowRight.tsx","../src/PhotoSlider.tsx","../src/PhotoProvider.tsx","../node_modules/lodash.uniqueid/index.js","../src/PhotoConsumer.tsx"],"names":["global","debounce","symbolTag","freeGlobal","freeSelf","root","objectProto","objectToString","isSymbol","isObjectLike"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import React from 'react';\nimport { dataType } from './types';\n\nexport type onShowType = (key?: string) => void;\n\nexport type addItemType = ({ key, src, originRef, intro }: dataType) => void;\n\nexport type removeItemType = (key?: string) => void;\n\nexport interface PhotoContextType {\n  onShow: onShowType;\n  addItem: addItemType;\n  removeItem: removeItemType;\n}\n\nexport default React.createContext<PhotoContextType>({\n  onShow() {},\n  addItem() {},\n  removeItem() {},\n});\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","import React from 'react';\nimport './Spinner.less';\n\nfunction Spinner() {\n  return (\n    <div className=\"PhotoView__Spinner\">\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\" width=\"36\" height=\"36\" fill=\"white\">\n        <path opacity=\".25\" d=\"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\" />\n        <path d=\"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\" />\n      </svg>\n    </div>\n  );\n}\n\nexport default Spinner;\n","/**\n * 获取图片合适的大小\n */\nexport default function getSuitableImageSize(\n  naturalWidth: number,\n  naturalHeight: number,\n): {\n  width: number;\n  height: number;\n} {\n  let width = 0;\n  let height = 0;\n  const { innerWidth, innerHeight } = window;\n  if (naturalWidth < innerWidth && naturalHeight < innerHeight) {\n    width = naturalWidth;\n    height = naturalHeight;\n  } else if (naturalWidth < innerWidth && naturalHeight >= innerHeight) {\n    width = (naturalWidth / naturalHeight) * innerHeight;\n    height = innerHeight;\n  } else if (naturalWidth >= innerWidth && naturalHeight < innerHeight) {\n    width = innerWidth;\n    height = (naturalHeight / naturalWidth) * innerWidth;\n  } else if (\n    naturalWidth >= innerWidth &&\n    naturalHeight >= innerHeight &&\n    naturalWidth / naturalHeight > innerWidth / innerHeight\n  ) {\n    width = innerWidth;\n    height = (naturalHeight / naturalWidth) * innerWidth;\n  } else {\n    width = (naturalWidth / naturalHeight) * innerHeight;\n    height = innerHeight;\n  }\n  return {\n    width: Math.floor(width),\n    height: Math.floor(height),\n  };\n}\n","import React from 'react';\n\nexport default function useMountedState(): () => boolean {\n  const mountedRef = React.useRef<boolean>(false);\n  React.useEffect(() => {\n    mountedRef.current = true;\n\n    return () => {\n      mountedRef.current = false;\n    };\n  });\n\n  return React.useCallback(() => mountedRef.current, []);\n}\n","import React from 'react';\nimport classNames from 'classnames';\nimport Spinner from './components/Spinner';\nimport getSuitableImageSize from './utils/getSuitableImageSize';\nimport useMountedState from './utils/useMountedState';\nimport './Photo.less';\n\nexport interface IPhotoProps extends React.HTMLAttributes<any> {\n  src: string;\n  loaded: boolean;\n  broken: boolean;\n  width: number;\n  height: number;\n  className?: string;\n  onImageLoad: (PhotoParams, callback?: Function) => void;\n  loadingElement?: JSX.Element;\n  brokenElement?: JSX.Element;\n}\n\nconst Photo: React.FC<IPhotoProps> = ({\n  src,\n  loaded,\n  broken,\n  width,\n  height,\n  className,\n  onImageLoad,\n  loadingElement,\n  brokenElement,\n  ...restProps\n}) => {\n  const isMounted = useMountedState();\n\n  function handleImageLoaded(e) {\n    const { naturalWidth, naturalHeight } = e.target;\n    if (isMounted()) {\n      onImageLoad({\n        loaded: true,\n        naturalWidth,\n        naturalHeight,\n        ...getSuitableImageSize(naturalWidth, naturalHeight),\n      });\n    }\n  }\n\n  function handleImageBroken() {\n    if (isMounted()) {\n      onImageLoad({\n        broken: true,\n      });\n    }\n  }\n\n  React.useEffect(() => {\n    const currPhoto = new Image();\n    currPhoto.onload = handleImageLoaded;\n    currPhoto.onerror = handleImageBroken;\n    currPhoto.src = src;\n  }, []);\n\n  if (src && !broken) {\n    if (loaded) {\n      return (\n        <img\n          className={classNames('PhotoView__Photo', className)}\n          src={src}\n          width={width}\n          height={height}\n          alt=\"\"\n          {...restProps}\n        />\n      );\n    }\n    return loadingElement || <Spinner />;\n  }\n  return brokenElement || null;\n};\n\nPhoto.displayName = 'Photo';\n\nexport default Photo;\n","import debounce from 'lodash.debounce';\n\n/**\n * throttle\n * @param func\n * @param wait\n */\nexport default function throttle(func, wait: number) {\n  return debounce(func, wait, {\n    leading: true,\n    maxWait: wait,\n    trailing: true,\n  });\n}\n","/**\n * 是否支持触摸设备\n */\nconst isTouchDevice = typeof document !== 'undefined' && 'ontouchstart' in document.documentElement;\n\nexport default isTouchDevice;\n","import React from 'react';\n\n/**\n * 从 Touch 事件中获取两个触控中心位置\n */\nexport default function getMultipleTouchPosition(\n  evt: React.TouchEvent,\n): {\n  clientX: number;\n  clientY: number;\n  touchLength: number;\n} {\n  const { clientX, clientY } = evt.touches[0];\n  if (evt.touches.length >= 2) {\n    const { clientX: nextClientX, clientY: nextClientY } = evt.touches[1];\n    return {\n      clientX: (clientX + nextClientX) / 2,\n      clientY: (clientY + nextClientY) / 2,\n      touchLength: Math.sqrt(Math.pow(nextClientX - clientX, 2) + Math.pow(nextClientY - clientY, 2)),\n    };\n  }\n  return { clientX, clientY, touchLength: 0 };\n}\n","/**\n * 获取移动或缩放之后的中心点\n */\nexport default function getPositionOnMoveOrScale({\n  x,\n  y,\n  clientX,\n  clientY,\n  offsetX = 0,\n  offsetY = 0,\n  fromScale,\n  toScale,\n}: {\n  x: number;\n  y: number;\n  clientX: number;\n  clientY: number;\n  offsetX?: number;\n  offsetY?: number;\n  fromScale: number;\n  toScale: number;\n}): {\n  x: number;\n  y: number;\n  scale: number;\n  lastMoveClientX: number;\n  lastMoveClientY: number;\n} {\n  const { innerWidth, innerHeight } = window;\n  const centerClientX = innerWidth / 2;\n  const centerClientY = innerHeight / 2;\n  // 坐标偏移\n  const lastPositionX = centerClientX + x;\n  const lastPositionY = centerClientY + y;\n\n  // 放大偏移量\n  const offsetScale = toScale / fromScale;\n  // 偏移位置\n  const originX = clientX - (clientX - lastPositionX) * offsetScale - centerClientX;\n  const originY = clientY - (clientY - lastPositionY) * offsetScale - centerClientY;\n  return {\n    x: originX + offsetX,\n    y: originY + offsetY,\n    scale: toScale,\n    lastMoveClientX: clientX,\n    lastMoveClientY: clientY,\n  };\n}\n","/**\n * 最大触摸时间\n */\nexport const maxTouchTime: number = 200;\n\n/**\n * 最大滑动切换图片距离\n */\nexport const maxMoveOffset: number = 40;\n\n/**\n * 图片的间隔\n */\nexport const horizontalOffset: number = 20;\n\n/**\n * 最小初始响应距离\n */\nexport const minStartTouchOffset: number = 10;\n\n/**\n * 默认背景透明度\n */\nexport const defaultOpacity: number = 1;\n\n/**\n * 最小缩放度\n */\nexport const minScale: number = 1;\n\n/**\n * 最大缩放度（若图片足够大，则会超出）\n */\nexport const maxScale: number = 6;\n\n/**\n * 滑动加速度\n */\nexport const slideAcceleration: number = 0.005;\n\n/**\n * 缩放弹性缓冲\n */\nexport const scaleBuffer: number = 0.2;\n","import React from 'react';\n\n/**\n * 图片 item 类型\n */\nexport type dataType = {\n  // 唯一标识\n  key?: string;\n  // 图片地址\n  src: string;\n  // 原触发 ref\n  originRef?: HTMLElement | null;\n  // 图片介绍\n  intro?: React.ReactNode;\n};\n\ntype overlayRenderProps = {\n  // 图片列表\n  images: dataType[];\n  // 图片当前索引\n  index: number;\n  // 可见\n  visible: boolean;\n  // 关闭事件\n  onClose: (evt?: React.MouseEvent | React.TouchEvent) => void;\n  // 索引改变回调\n  onIndexChange: (photoIndex: number) => void;\n  // 覆盖物可见度\n  overlayVisible: boolean;\n};\n\nexport interface IPhotoProviderBase {\n  // 背景可点击关闭，默认 true\n  maskClosable?: boolean;\n  // 图片点击可关闭，默认 false\n  photoClosable?: boolean;\n  // 导航条 visible，默认 true\n  bannerVisible?: boolean;\n  // 简介 visible，默认 true\n  introVisible?: boolean;\n  // 自定义渲染\n  overlayRender?: (overlayProps: overlayRenderProps) => React.ReactNode;\n  // className\n  className?: string;\n  // 遮罩 className\n  maskClassName?: string;\n  // 图片容器 className\n  viewClassName?: string;\n  // 图片 className\n  imageClassName?: string;\n  // 自定义 loading\n  loadingElement?: JSX.Element;\n  // 加载失败 Element\n  brokenElement?: JSX.Element;\n}\n\nexport type ReachMoveFunction = (reachState: ReachTypeEnum, clientX: number, clientY: number, scale?: number) => void;\n\nexport type ReachFunction = (clientX: number, clientY: number) => void;\n\nexport type PhotoTapFunction = (clientX: number, clientY: number) => void;\n\n/**\n * 边缘超出状态\n */\nexport enum CloseEdgeEnum {\n  Normal, // 正常滑动\n  Small, // 小于屏幕宽度\n  Before, // 抵触左边/上边\n  After, // 抵触右边/下边\n}\n\n/**\n * 边缘触发状态\n */\nexport enum ReachTypeEnum {\n  Normal, // 未触发\n  XReach, // x 轴\n  YReach, // y 轴\n}\n\n/**\n * 初始响应状态\n */\nexport enum TouchStartEnum {\n  Normal, // 未触发\n  X, // X 轴优先\n  YPush, // Y 轴往上\n  YPull, // Y 轴往下\n}\n\n/**\n * 动画类型\n */\nexport enum ShowAnimateEnum {\n  None, // 无\n  In, // 进入\n  Out, // 离开\n}\n\n/**\n * 触发源位置\n */\nexport type OriginRectType =\n  | {\n      clientX: number;\n      clientY: number;\n    }\n  | undefined;\n","import { CloseEdgeEnum, ReachTypeEnum, TouchStartEnum } from '../types';\n\n/**\n * 接触左边或右边边缘\n * @param x\n * @param scale\n * @param width\n * @return CloseEdgeEnum\n */\nexport function getClosedHorizontal(x: number, scale: number, width: number): CloseEdgeEnum {\n  const { innerWidth } = window;\n  const currentWidth = width * scale;\n  // 图片超出的宽度\n  const outOffsetX = (currentWidth - innerWidth) / 2;\n  if (currentWidth <= innerWidth) {\n    return CloseEdgeEnum.Small;\n  } else if (x > 0 && outOffsetX - x <= 0) {\n    return CloseEdgeEnum.Before;\n  } else if (x < 0 && outOffsetX + x <= 0) {\n    return CloseEdgeEnum.After;\n  }\n  return CloseEdgeEnum.Normal;\n}\n\n/**\n * 接触上边或下边边缘\n * @param y\n * @param scale\n * @param height\n * @return CloseEdgeEnum\n */\nexport function getClosedVertical(y: number, scale: number, height: number): CloseEdgeEnum {\n  const { innerHeight } = window;\n  const currentHeight = height * scale;\n  // 图片超出的高度\n  const outOffsetY = (currentHeight - innerHeight) / 2;\n\n  if (currentHeight <= innerHeight) {\n    return CloseEdgeEnum.Small;\n  } else if (y > 0 && outOffsetY - y <= 0) {\n    return CloseEdgeEnum.Before;\n  } else if (y < 0 && outOffsetY + y <= 0) {\n    return CloseEdgeEnum.After;\n  }\n  return CloseEdgeEnum.Normal;\n}\n\n/**\n * 获取接触边缘类型\n * @param initialTouchState\n * @param horizontalCloseEdge\n * @param verticalCloseEdge\n * @param reachState\n */\nexport function getReachType({\n  initialTouchState,\n  horizontalCloseEdge,\n  verticalCloseEdge,\n  reachState,\n}: {\n  initialTouchState: TouchStartEnum;\n  horizontalCloseEdge: CloseEdgeEnum;\n  verticalCloseEdge: CloseEdgeEnum;\n  reachState: ReachTypeEnum;\n}): ReachTypeEnum {\n  if ((horizontalCloseEdge > 0 && initialTouchState === TouchStartEnum.X) || reachState === ReachTypeEnum.XReach) {\n    return ReachTypeEnum.XReach;\n  } else if (\n    (verticalCloseEdge > 0 &&\n      (initialTouchState === TouchStartEnum.YPull || initialTouchState === TouchStartEnum.YPush)) ||\n    reachState === ReachTypeEnum.YReach\n  ) {\n    return ReachTypeEnum.YReach;\n  }\n  return ReachTypeEnum.Normal;\n}\n","import { maxTouchTime, slideAcceleration } from '../variables';\nimport { CloseEdgeEnum } from '../types';\nimport { getClosedHorizontal, getClosedVertical } from './getCloseEdge';\n\n/**\n * 适应到合适的图片偏移量\n */\nexport default function slideToPosition({\n  x,\n  y,\n  lastX,\n  lastY,\n  width,\n  height,\n  scale,\n  touchedTime,\n}: {\n  x: number;\n  y: number;\n  lastX: number;\n  lastY: number;\n  width: number;\n  height: number;\n  scale: number;\n  touchedTime: number;\n}): {\n  x: number;\n  y: number;\n} {\n  const moveTime = Date.now() - touchedTime;\n\n  // 初始速度\n  const speedX = (x - lastX) / moveTime;\n  const speedY = (y - lastY) / moveTime;\n\n  // 停下所消耗时间\n  const slideTimeX = Math.abs(speedX / slideAcceleration);\n  const slideTimeY = Math.abs(speedY / slideAcceleration);\n\n  // 计划滑动位置\n  const planX = Math.floor(x + speedX * slideTimeX);\n  const planY = Math.floor(y + speedY * slideTimeY);\n\n  let currentX = planX;\n  let currentY = planY;\n\n  const { innerWidth, innerHeight } = window;\n  // 图片超出的长度\n  const outOffsetX = (width * scale - innerWidth) / 2;\n  const outOffsetY = (height * scale - innerHeight) / 2;\n\n  const horizontalCloseEdge = getClosedHorizontal(planX, scale, width);\n  const verticalCloseEdge = getClosedVertical(planY, scale, height);\n\n  // x\n  if (horizontalCloseEdge === CloseEdgeEnum.Small) {\n    currentX = 0;\n  } else if (horizontalCloseEdge === CloseEdgeEnum.Before) {\n    currentX = outOffsetX;\n  } else if (horizontalCloseEdge === CloseEdgeEnum.After) {\n    currentX = -outOffsetX;\n  }\n  // y\n  if (verticalCloseEdge === CloseEdgeEnum.Small) {\n    currentY = 0;\n  } else if (verticalCloseEdge === CloseEdgeEnum.Before) {\n    currentY = outOffsetY;\n  } else if (verticalCloseEdge === CloseEdgeEnum.After) {\n    currentY = -outOffsetY;\n  }\n\n  // 时间过长\n  if (\n    moveTime >= maxTouchTime &&\n    horizontalCloseEdge === CloseEdgeEnum.Normal && verticalCloseEdge === CloseEdgeEnum.Normal\n  ) {\n    return {\n      x,\n      y,\n    };\n  }\n  return {\n    x: currentX,\n    y: currentY,\n  };\n}\n","import debounce from 'lodash.debounce';\n\nexport type TapFuncType<T> = (...args: T[]) => void;\n\n/**\n * 单击和双击事件处理\n * @param singleTap - 单击事件\n * @param doubleTap - 双击事件\n * @return invokeTap\n */\nexport default function withContinuousTap<T>(singleTap: TapFuncType<T>, doubleTap: TapFuncType<T>): TapFuncType<T> {\n  // 当前连续点击次数\n  let continuousClick = 0;\n\n  const withDebounceTap = debounce((...args) => {\n    continuousClick = 0;\n    singleTap(...args);\n  }, 300);\n\n  return function invokeTap(...args) {\n    continuousClick += 1;\n    withDebounceTap(...args);\n    // 双击\n    if (continuousClick >= 2) {\n      withDebounceTap.cancel();\n      continuousClick = 0;\n      doubleTap(...args);\n    }\n  };\n}\n","import { OriginRectType } from '../types';\n\nexport default function getAnimateOrigin(\n  originRect: OriginRectType,\n  width: number,\n  height: number,\n): string | undefined {\n  if (originRect) {\n    const { innerWidth, innerHeight } = window;\n\n    const xOrigin = (width - innerWidth) / 2 + originRect.clientX;\n    const yOrigin = (height - innerHeight) / 2 + originRect.clientY;\n\n    return `${xOrigin}px ${yOrigin}px`;\n  }\n\n  return undefined;\n}\n","import React from 'react';\nimport classNames from 'classnames';\nimport Photo from './Photo';\nimport throttle from './utils/throttle';\nimport isTouchDevice from './utils/isTouchDevice';\nimport getMultipleTouchPosition from './utils/getMultipleTouchPosition';\nimport getPositionOnMoveOrScale from './utils/getPositionOnMoveOrScale';\nimport slideToPosition from './utils/slideToPosition';\nimport { getReachType, getClosedHorizontal, getClosedVertical } from './utils/getCloseEdge';\nimport withContinuousTap, { TapFuncType } from './utils/withContinuousTap';\nimport getAnimateOrigin from './utils/getAnimateOrigin';\nimport { maxScale, minStartTouchOffset, minScale, scaleBuffer } from './variables';\nimport {\n  ReachMoveFunction,\n  ReachFunction,\n  PhotoTapFunction,\n  ReachTypeEnum,\n  TouchStartEnum,\n  ShowAnimateEnum,\n  OriginRectType,\n} from './types';\nimport './PhotoView.less';\nimport getSuitableImageSize from './utils/getSuitableImageSize';\n\nexport interface IPhotoViewProps {\n  // 图片地址\n  src: string;\n  // 容器类名\n  viewClassName?: string;\n  // 图片类名\n  className?: string;\n  // style\n  style?: object;\n  // 自定义 loading\n  loadingElement?: JSX.Element;\n  // 加载失败 Element\n  brokenElement?: JSX.Element;\n\n  // Photo 点击事件\n  onPhotoTap: PhotoTapFunction;\n  // Mask 点击事件\n  onMaskTap: PhotoTapFunction;\n  // 到达边缘滑动事件\n  onReachMove: ReachMoveFunction;\n  // 触摸解除事件\n  onReachUp: ReachFunction;\n  // Resize 事件\n  onPhotoResize?: () => void;\n  // 是否在当前操作中\n  isActive: boolean;\n\n  // 动画类型\n  showAnimateType?: ShowAnimateEnum;\n  // 动画源位置\n  originRect?: OriginRectType;\n}\n\nconst initialState = {\n  // 真实宽度\n  naturalWidth: 1,\n  // 真实高度\n  naturalHeight: 1,\n  // 宽度\n  width: 1,\n  // 高度\n  height: 1,\n  // 加载成功状态\n  loaded: false,\n  // 破碎状态\n  broken: false,\n\n  // 图片 X 偏移量\n  x: 0,\n  // 图片 y 偏移量\n  y: 0,\n  // 图片缩放程度\n  scale: 1,\n  // 图片处于触摸的状态\n  touched: false,\n  // 背景处于触摸状态\n  maskTouched: false,\n\n  // 触摸开始时 x 原始坐标\n  clientX: 0,\n  // 触摸开始时 y 原始坐标\n  clientY: 0,\n\n  // 触摸开始时图片 x 偏移量\n  lastX: 0,\n  // 触摸开始时图片 y 偏移量\n  lastY: 0,\n  // 上一个触摸状态 x 原始坐标\n  lastMoveClientX: 0,\n  // 上一个触摸状态 y 原始坐标\n  lastMoveClientY: 0,\n\n  // 触摸开始时时间\n  touchedTime: 0,\n  // 多指触控间距\n  lastTouchLength: 0,\n\n  // 当前边缘触发状态\n  reachState: ReachTypeEnum.Normal,\n};\n\nexport default class PhotoView extends React.Component<IPhotoViewProps, typeof initialState> {\n  static displayName = 'PhotoView';\n\n  readonly state = initialState;\n  // 初始响应状态\n  private initialTouchState = TouchStartEnum.Normal;\n\n  private readonly handlePhotoTap: TapFuncType<number>;\n\n  constructor(props: IPhotoViewProps) {\n    super(props);\n    this.onMove = throttle(this.onMove, 8);\n    this.handleResize = throttle(this.handleResize, 8);\n    // 单击与双击事件处理\n    this.handlePhotoTap = withContinuousTap(this.onPhotoTap, this.onDoubleTap);\n  }\n\n  componentDidMount() {\n    if (isTouchDevice) {\n      window.addEventListener('touchmove', this.handleTouchMove, { passive: false });\n      window.addEventListener('touchend', this.handleTouchEnd, { passive: false });\n    } else {\n      window.addEventListener('mousemove', this.handleMouseMove);\n      window.addEventListener('mouseup', this.handleMouseUp);\n    }\n    window.addEventListener('resize', this.handleResize);\n  }\n\n  componentWillUnmount() {\n    if (isTouchDevice) {\n      window.removeEventListener('touchmove', this.handleTouchMove);\n      window.removeEventListener('touchend', this.handleTouchEnd);\n    } else {\n      window.removeEventListener('mousemove', this.handleMouseMove);\n      window.removeEventListener('mouseup', this.handleMouseUp);\n    }\n    window.removeEventListener('resize', this.handleResize);\n  }\n\n  handleImageLoad = imageParams => {\n    this.setState(imageParams);\n  };\n\n  handleResize = () => {\n    const { onPhotoResize } = this.props;\n    const { loaded, naturalWidth, naturalHeight } = this.state;\n    if (loaded) {\n      this.setState(getSuitableImageSize(naturalWidth, naturalHeight));\n      if (onPhotoResize) {\n        onPhotoResize();\n      }\n    }\n  };\n\n  handleStart = (clientX: number, clientY: number, touchLength: number = 0) => {\n    this.setState(prevState => ({\n      touched: true,\n      clientX,\n      clientY,\n      lastMoveClientX: clientX,\n      lastMoveClientY: clientY,\n      lastX: prevState.x,\n      lastY: prevState.y,\n      lastTouchLength: touchLength,\n      touchedTime: Date.now(),\n    }));\n  };\n\n  onMove = (newClientX: number, newClientY: number, touchLength: number = 0) => {\n    const { onReachMove, isActive } = this.props;\n    const {\n      width,\n      height,\n      naturalWidth,\n      x,\n      y,\n      clientX,\n      clientY,\n      lastMoveClientX,\n      lastMoveClientY,\n      lastX,\n      lastY,\n      scale,\n      lastTouchLength,\n      reachState,\n      touched,\n      maskTouched,\n    } = this.state;\n    if ((touched || maskTouched) && isActive) {\n      // 单指最小缩放下，以初始移动距离来判断意图\n      if (touchLength === 0 && this.initialTouchState === TouchStartEnum.Normal) {\n        const isStillX = Math.abs(newClientX - clientX) <= minStartTouchOffset;\n        const isStillY = Math.abs(newClientY - clientY) <= minStartTouchOffset;\n        // 初始移动距离不足\n        if (isStillX && isStillY) {\n          // 方向记录上次移动距离，以便平滑过渡\n          this.setState({\n            lastMoveClientX: newClientX,\n            lastMoveClientY: newClientY,\n          });\n          return;\n        }\n        // 设置响应状态\n        this.initialTouchState = !isStillX\n          ? TouchStartEnum.X\n          : newClientY > clientY\n          ? TouchStartEnum.YPull\n          : TouchStartEnum.YPush;\n      }\n\n      let offsetX = newClientX - lastMoveClientX;\n      let offsetY = newClientY - lastMoveClientY;\n      // 边缘触发状态\n      let currentReachState = ReachTypeEnum.Normal;\n      if (touchLength === 0) {\n        // 边缘超出状态\n        const horizontalCloseEdge = getClosedHorizontal(offsetX + lastX, scale, width);\n        const verticalCloseEdge = getClosedVertical(offsetY + lastY, scale, height);\n        // 边缘触发检测\n        currentReachState = getReachType({\n          initialTouchState: this.initialTouchState,\n          horizontalCloseEdge,\n          verticalCloseEdge,\n          reachState,\n        });\n\n        // 接触边缘\n        if (currentReachState != ReachTypeEnum.Normal) {\n          onReachMove(currentReachState, newClientX, newClientY, scale);\n        }\n      }\n      // 横向边缘触发、背景触发禁用当前滑动\n      if (currentReachState === ReachTypeEnum.XReach || maskTouched) {\n        this.setState({\n          reachState: ReachTypeEnum.XReach,\n        });\n      } else {\n        // 目标倍数\n        const endScale = scale + ((touchLength - lastTouchLength) / 100 / 2) * scale;\n        // 限制最大倍数和最小倍数\n        const toScale = Math.max(Math.min(endScale, Math.max(maxScale, naturalWidth / width)), minScale - scaleBuffer);\n        this.setState({\n          lastTouchLength: touchLength,\n          reachState: currentReachState,\n          ...getPositionOnMoveOrScale({\n            x,\n            y,\n            clientX: newClientX,\n            clientY: newClientY,\n            offsetX,\n            offsetY,\n            fromScale: scale,\n            toScale,\n          }),\n        });\n      }\n    }\n  };\n\n  onPhotoTap = (clientX: number, clientY: number) => {\n    const { onPhotoTap } = this.props;\n    if (onPhotoTap) {\n      onPhotoTap(clientX, clientY);\n    }\n  };\n\n  onDoubleTap: TapFuncType<number> = (clientX, clientY) => {\n    const { width, naturalWidth } = this.state;\n    const { x, y, scale } = this.state;\n    this.setState({\n      clientX,\n      clientY,\n      ...getPositionOnMoveOrScale({\n        x,\n        y,\n        clientX,\n        clientY,\n        fromScale: scale,\n        // 若图片足够大，则放大适应的倍数\n        toScale: scale !== 1 ? 1 : Math.max(2, naturalWidth / width),\n      }),\n    });\n  };\n\n  handleWheel = e => {\n    const { clientX, clientY, deltaY } = e;\n    const { width, naturalWidth } = this.state;\n    this.setState(({ x, y, scale }) => {\n      const endScale = scale - deltaY / 100 / 2;\n      // 限制最大倍数和最小倍数\n      const toScale = Math.max(Math.min(endScale, Math.max(maxScale, naturalWidth / width)), minScale);\n      return {\n        clientX,\n        clientY,\n        ...getPositionOnMoveOrScale({\n          x,\n          y,\n          clientX,\n          clientY,\n          fromScale: scale,\n          toScale,\n        }),\n      };\n    });\n  };\n\n  handleMaskStart = (clientX: number, clientY: number) => {\n    this.setState(prevState => ({\n      maskTouched: true,\n      clientX,\n      clientY,\n      lastX: prevState.x,\n      lastY: prevState.y,\n    }));\n  };\n\n  handleMaskMouseDown = e => {\n    this.handleMaskStart(e.clientX, e.clientY);\n  };\n\n  handleMaskTouchStart = e => {\n    const { clientX, clientY } = e.touches[0];\n    this.handleMaskStart(clientX, clientY);\n  };\n\n  handleTouchStart = e => {\n    const { clientX, clientY, touchLength } = getMultipleTouchPosition(e);\n    this.handleStart(clientX, clientY, touchLength);\n  };\n\n  handleMouseDown = e => {\n    e.preventDefault();\n    this.handleStart(e.clientX, e.clientY, 0);\n  };\n\n  handleTouchMove = e => {\n    e.preventDefault();\n    const { clientX, clientY, touchLength } = getMultipleTouchPosition(e);\n    this.onMove(clientX, clientY, touchLength);\n  };\n\n  handleMouseMove = e => {\n    e.preventDefault();\n    this.onMove(e.clientX, e.clientY);\n  };\n\n  handleUp = (newClientX: number, newClientY: number) => {\n    // 重置响应状态\n    this.initialTouchState = TouchStartEnum.Normal;\n    const { onReachUp, onPhotoTap, onMaskTap, isActive } = this.props;\n    const {\n      width,\n      height,\n      naturalWidth,\n      x,\n      y,\n      lastX,\n      lastY,\n      scale,\n      touchedTime,\n      clientX,\n      clientY,\n      touched,\n      maskTouched,\n    } = this.state;\n    if ((touched || maskTouched) && isActive) {\n      const hasMove = clientX !== newClientX || clientY !== newClientY;\n      this.setState(\n        {\n          touched: false,\n          maskTouched: false,\n          // 限制缩放\n          scale: Math.max(Math.min(scale, Math.max(maxScale, naturalWidth / width)), minScale),\n          reachState: ReachTypeEnum.Normal, // 重置触发状态\n          ...(hasMove\n            ? slideToPosition({\n                x,\n                y,\n                lastX,\n                lastY,\n                width,\n                height,\n                scale,\n                touchedTime,\n              })\n            : {\n                x,\n                y,\n              }),\n        },\n        () => {\n          if (onReachUp) {\n            onReachUp(newClientX, newClientY);\n          }\n          // 触发 Tap 事件\n          if (!hasMove) {\n            if (touched && onPhotoTap) {\n              this.handlePhotoTap(newClientX, newClientY);\n            } else if (maskTouched && onMaskTap) {\n              onMaskTap(newClientX, newClientY);\n            }\n          }\n        },\n      );\n    }\n  };\n\n  handleTouchEnd = e => {\n    const { clientX, clientY } = e.changedTouches[0];\n    this.handleUp(clientX, clientY);\n  };\n\n  handleMouseUp = e => {\n    const { clientX, clientY } = e;\n    this.handleUp(clientX, clientY);\n  };\n\n  render() {\n    const {\n      src,\n      viewClassName,\n      className,\n      style,\n      loadingElement,\n      brokenElement,\n      isActive,\n      showAnimateType,\n      originRect,\n    } = this.props;\n    const { width, height, loaded, x, y, scale, touched, broken } = this.state;\n\n    const transform = `translate3d(${x}px, ${y}px, 0) scale(${scale})`;\n\n    return (\n      <div className={classNames('PhotoView__PhotoWrap', viewClassName)} style={style}>\n        <div\n          className=\"PhotoView__PhotoMask\"\n          onMouseDown={!isTouchDevice && isActive ? this.handleMaskMouseDown : undefined}\n          onTouchStart={isTouchDevice && isActive ? this.handleMaskTouchStart : undefined}\n        />\n        <div\n          className={classNames({\n            PhotoView__animateIn: loaded && showAnimateType === ShowAnimateEnum.In,\n            PhotoView__animateOut: loaded && showAnimateType === ShowAnimateEnum.Out,\n          })}\n          style={{\n            transformOrigin: loaded ? getAnimateOrigin(originRect, width, height) : undefined,\n          }}\n        >\n          <Photo\n            className={className}\n            src={src}\n            width={width}\n            height={height}\n            loaded={loaded}\n            broken={broken}\n            onMouseDown={isTouchDevice ? undefined : this.handleMouseDown}\n            onTouchStart={isTouchDevice ? this.handleTouchStart : undefined}\n            onWheel={this.handleWheel}\n            style={{\n              WebkitTransform: transform,\n              transform,\n              transition: touched ? undefined : 'transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1)',\n            }}\n            onImageLoad={this.handleImageLoad}\n            loadingElement={loadingElement}\n            brokenElement={brokenElement}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { createPortal } from 'react-dom';\nimport classNames from 'classnames';\nimport './SlideWrap.less';\n\nconst SlideWrap: React.FC<React.HTMLAttributes<HTMLDivElement>> = ({ className, children, ...restProps }) => {\n  const dialogNode = React.useMemo(() => {\n    // 容器\n    const dialogNode = document.createElement('section');\n    document.body.appendChild(dialogNode);\n    return dialogNode;\n  }, [] as readonly []);\n  const originalOverflowCallback = React.useRef('');\n\n  React.useEffect(() => {\n    const { style } = document.body;\n    originalOverflowCallback.current = style.overflow;\n    style.overflow = 'hidden';\n\n    return () => {\n      const { style } = document.body;\n      style.overflow = originalOverflowCallback.current;\n      // 清除容器\n      document.body.removeChild(dialogNode);\n    };\n  }, [] as readonly []);\n\n  return createPortal(\n    <div className={classNames('PhotoView-SlideWrap', className)} {...restProps}>\n      {children}\n    </div>,\n    dialogNode,\n  );\n};\n\nSlideWrap.displayName = 'SlideWrap';\n\nexport default SlideWrap;\n","import React from 'react';\nimport { dataType, OriginRectType, ShowAnimateEnum } from '../types';\n\ninterface VisibleHandleProps {\n  visible: boolean;\n  currentImage?: dataType;\n  children: ({\n    photoVisible,\n    showAnimateType,\n    originRect,\n    onShowAnimateEnd,\n  }: {\n    photoVisible: boolean;\n    showAnimateType: ShowAnimateEnum;\n    originRect: OriginRectType;\n    onShowAnimateEnd: () => void;\n  }) => JSX.Element | null;\n}\n\nexport default function VisibleAnimationHandle({ visible, currentImage, children }: VisibleHandleProps) {\n  const [photoVisible, updatePhotoVisible] = React.useState(visible);\n  const [showAnimateType, updateAnimateStatus] = React.useState<ShowAnimateEnum>(ShowAnimateEnum.None);\n  const [originRect, updateOriginRect] = React.useState<OriginRectType>();\n\n  function onShowAnimateEnd() {\n    updateAnimateStatus(ShowAnimateEnum.None);\n\n    // Close\n    if (showAnimateType === ShowAnimateEnum.Out) {\n      updatePhotoVisible(false);\n    }\n  }\n\n  React.useEffect(() => {\n    if (!currentImage) {\n      return;\n    }\n    const originRef = currentImage.originRef;\n    if (originRef && originRef.nodeType === 1) {\n      // 获取触发时节点位置\n      const { top, left, width, height } = originRef.getBoundingClientRect();\n      updateOriginRect({\n        clientX: left + width / 2,\n        clientY: top + height / 2,\n      });\n    } else if (originRect && !originRef) {\n      updateOriginRect(undefined);\n    }\n\n    if (visible) {\n      updateAnimateStatus(ShowAnimateEnum.In);\n      updatePhotoVisible(true);\n    } else {\n      updateAnimateStatus(ShowAnimateEnum.Out);\n    }\n  }, [visible]);\n\n  return children({\n    photoVisible,\n    showAnimateType,\n    originRect,\n    onShowAnimateEnd,\n  });\n}\n","import React from 'react';\n\nfunction CloseSVG(props) {\n  return (\n    <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path\n        fill=\"#FFF\"\n        d=\"M607.5 205.5l-178.5 178.5 178.5 178.5-45 45-178.5-178.5-178.5 178.5-45-45 178.5-178.5-178.5-178.5 45-45 178.5 178.5 178.5-178.5z\"\n      />\n    </svg>\n  );\n}\n\nexport default CloseSVG;\n","import React from 'react';\n\nfunction ArrowLeft(props) {\n  return (\n    <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path d=\"M640.5 352.5v63h-390l178.5 180-45 45-256.5-256.5 256.5-256.5 45 45-178.5 180h390z\" />\n    </svg>\n  );\n}\n\nexport default ArrowLeft;\n","import React from 'react';\n\nfunction ArrowRight(props) {\n  return (\n    <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path d=\"M384 127.5l256.5 256.5-256.5 256.5-45-45 178.5-180h-390v-63h390l-178.5-180z\" />\n    </svg>\n  );\n}\n\nexport default ArrowRight;\n","import React from 'react';\nimport classNames from 'classnames';\nimport debounce from 'lodash.debounce';\nimport PhotoView from './PhotoView';\nimport SlideWrap from './components/SlideWrap';\nimport VisibleAnimationHandle from './components/VisibleAnimationHandle';\nimport CloseSVG from './components/CloseSVG';\nimport ArrowLeft from './components/ArrowLeft';\nimport ArrowRight from './components/ArrowRight';\nimport isTouchDevice from './utils/isTouchDevice';\nimport { dataType, IPhotoProviderBase, ReachTypeEnum, ShowAnimateEnum } from './types';\nimport { defaultOpacity, horizontalOffset, maxMoveOffset } from './variables';\nimport './PhotoSlider.less';\n\nexport interface IPhotoSliderProps extends IPhotoProviderBase {\n  // 图片列表\n  images: dataType[];\n  // 图片当前索引\n  index?: number;\n  // 可见\n  visible: boolean;\n  // 关闭事件\n  onClose: (evt?: React.MouseEvent | React.TouchEvent) => void;\n  // 索引改变回调\n  onIndexChange?: Function;\n}\n\ntype PhotoSliderState = {\n  // 偏移量\n  translateX: number;\n  // 图片当前的 index\n  photoIndex: number;\n\n  // 图片处于触摸的状态\n  touched: boolean;\n  // 该状态是否需要 transition\n  shouldTransition: boolean;\n  // Reach 开始时 x 坐标\n  lastClientX: number | undefined;\n  // Reach 开始时 y 坐标\n  lastClientY: number | undefined;\n  // 背景透明度\n  backdropOpacity: number;\n  // 上次关闭的背景透明度\n  lastBackdropOpacity: number;\n  // 覆盖物可见度\n  overlayVisible: boolean;\n  // 可下拉关闭\n  canPullClose: boolean;\n};\n\nexport default class PhotoSlider extends React.Component<IPhotoSliderProps, PhotoSliderState> {\n  static displayName = 'PhotoSlider';\n\n  static defaultProps = {\n    maskClosable: true,\n    photoClosable: false,\n    bannerVisible: true,\n    introVisible: true,\n  };\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    if (nextProps.index !== undefined && nextProps.index !== prevState.photoIndex) {\n      return {\n        photoIndex: nextProps.index,\n        translateX: -(window.innerWidth + horizontalOffset) * nextProps.index,\n      };\n    }\n    return null;\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      translateX: 0,\n      photoIndex: 0,\n      touched: false,\n      shouldTransition: true,\n\n      lastClientX: undefined,\n      lastClientY: undefined,\n      backdropOpacity: defaultOpacity,\n      lastBackdropOpacity: defaultOpacity,\n      overlayVisible: true,\n      canPullClose: true,\n    };\n    this.handleResize = debounce(this.handleResize, 32);\n  }\n\n  componentDidMount() {\n    const { index = 0 } = this.props;\n    this.setState({\n      translateX: index * -(window.innerWidth + horizontalOffset),\n      photoIndex: index,\n    });\n    window.addEventListener('keydown', this.handleKeyDown);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  }\n\n  handleClose = () => {\n    const { onClose } = this.props;\n    const { backdropOpacity } = this.state;\n    onClose();\n    this.setState({\n      overlayVisible: true,\n      // 记录当前关闭时的透明度\n      lastBackdropOpacity: backdropOpacity,\n    });\n  };\n\n  handlePhotoTap = () => {\n    const { photoClosable } = this.props;\n    if (photoClosable) {\n      this.handleClose();\n    } else {\n      this.setState(prevState => ({\n        overlayVisible: !prevState.overlayVisible,\n      }));\n    }\n  };\n\n  handlePhotoMaskTap = () => {\n    const { maskClosable } = this.props;\n    if (maskClosable) {\n      this.handleClose();\n    }\n  };\n\n  handleResize = () => {\n    const { innerWidth } = window;\n    this.setState(({ photoIndex }) => {\n      return {\n        translateX: -(innerWidth + horizontalOffset) * photoIndex,\n        lastClientX: undefined,\n        lastClientY: undefined,\n      };\n    });\n  };\n\n  handleKeyDown = (evt: KeyboardEvent) => {\n    const { visible } = this.props;\n    if (visible) {\n      switch (evt.key) {\n        case 'ArrowLeft':\n          this.handlePrevious(false);\n          break;\n        case 'ArrowRight':\n          this.handleNext(false);\n          break;\n        case 'Escape':\n          this.handleClose();\n          break;\n      }\n    }\n  };\n\n  handleReachVerticalMove = (clientY, scale) => {\n    this.setState(({ lastClientY, backdropOpacity }) => {\n      if (lastClientY === undefined) {\n        return {\n          touched: true,\n          lastClientY: clientY,\n          backdropOpacity,\n          canPullClose: true,\n        };\n      }\n      const offsetClientY = Math.abs(clientY - lastClientY);\n      const opacity = Math.max(Math.min(defaultOpacity, defaultOpacity - offsetClientY / 100 / 2), 0);\n      return {\n        touched: true,\n        lastClientY,\n        backdropOpacity: scale === 1 ? opacity : defaultOpacity,\n        canPullClose: scale === 1,\n      };\n    });\n  };\n\n  handleReachHorizontalMove = clientX => {\n    const { innerWidth } = window;\n    const { images } = this.props;\n    this.setState(({ lastClientX, translateX, photoIndex }) => {\n      if (lastClientX === undefined) {\n        return {\n          touched: true,\n          lastClientX: clientX,\n          translateX,\n          shouldTransition: true,\n        };\n      }\n      const originOffsetClientX = clientX - lastClientX;\n      let offsetClientX = originOffsetClientX;\n\n      // 第一张和最后一张超出距离减半\n      if (\n        (photoIndex === 0 && originOffsetClientX > 0) ||\n        (photoIndex === images.length - 1 && originOffsetClientX < 0)\n      ) {\n        offsetClientX = originOffsetClientX / 2;\n      }\n      return {\n        touched: true,\n        lastClientX: lastClientX,\n        translateX: -(innerWidth + horizontalOffset) * photoIndex + offsetClientX,\n        shouldTransition: true,\n      };\n    });\n  };\n\n  handleIndexChange = (photoIndex: number, shouldTransition: boolean = true) => {\n    const singlePageWidth = window.innerWidth + horizontalOffset;\n    const translateX = -singlePageWidth * photoIndex;\n    this.setState({\n      touched: false,\n      lastClientX: undefined,\n      lastClientY: undefined,\n      translateX,\n      photoIndex,\n      shouldTransition,\n    });\n    const { onIndexChange } = this.props;\n    if (onIndexChange) {\n      onIndexChange(photoIndex);\n    }\n  };\n\n  handlePrevious = (shouldTransition?: boolean) => {\n    const { photoIndex } = this.state;\n    if (photoIndex > 0) {\n      this.handleIndexChange(photoIndex - 1, shouldTransition);\n    }\n  };\n\n  handleNext = (shouldTransition?: boolean) => {\n    const { images } = this.props;\n    const { photoIndex } = this.state;\n    if (photoIndex < images.length - 1) {\n      this.handleIndexChange(photoIndex + 1, shouldTransition);\n    }\n  };\n\n  handleReachMove = (reachState: ReachTypeEnum, clientX: number, clientY: number, scale?: number) => {\n    if (reachState === ReachTypeEnum.XReach) {\n      this.handleReachHorizontalMove(clientX);\n    } else if (reachState === ReachTypeEnum.YReach) {\n      this.handleReachVerticalMove(clientY, scale);\n    }\n  };\n\n  handleReachUp = (clientX: number, clientY: number) => {\n    const { images } = this.props;\n    const { lastClientX = clientX, lastClientY = clientY, photoIndex, overlayVisible, canPullClose } = this.state;\n\n    const offsetClientX = clientX - lastClientX;\n    const offsetClientY = clientY - lastClientY;\n    let willClose = false;\n    // 下一张\n    if (offsetClientX < -maxMoveOffset && photoIndex < images.length - 1) {\n      this.handleIndexChange(photoIndex + 1);\n      return;\n    }\n    // 上一张\n    if (offsetClientX > maxMoveOffset && photoIndex > 0) {\n      this.handleIndexChange(photoIndex - 1);\n      return;\n    }\n    const singlePageWidth = window.innerWidth + horizontalOffset;\n\n    // 当前偏移\n    let currentTranslateX = -singlePageWidth * photoIndex;\n    let currentPhotoIndex = photoIndex;\n\n    if (Math.abs(offsetClientY) > window.innerHeight * 0.14 && canPullClose) {\n      willClose = true;\n      this.handleClose();\n    }\n    this.setState({\n      touched: false,\n      translateX: currentTranslateX,\n      photoIndex: currentPhotoIndex,\n      lastClientX: undefined,\n      lastClientY: undefined,\n      backdropOpacity: defaultOpacity,\n      overlayVisible: willClose ? true : overlayVisible,\n    });\n  };\n\n  render() {\n    const {\n      images,\n      visible,\n      className,\n      maskClassName,\n      viewClassName,\n      imageClassName,\n      bannerVisible,\n      introVisible,\n      overlayRender,\n      loadingElement,\n      brokenElement,\n    } = this.props;\n    const {\n      translateX,\n      touched,\n      photoIndex,\n      backdropOpacity,\n      lastBackdropOpacity,\n      overlayVisible,\n      shouldTransition,\n    } = this.state;\n    const imageLength = images.length;\n    const currentImage = images.length ? images[photoIndex] : undefined;\n    const transform = `translate3d(${translateX}px, 0px, 0)`;\n    // Overlay\n    const overlayIntro = currentImage && currentImage.intro;\n\n    return (\n      <VisibleAnimationHandle visible={visible} currentImage={currentImage}>\n        {({ photoVisible, showAnimateType, originRect, onShowAnimateEnd }) => {\n          if (photoVisible) {\n            const { innerWidth } = window;\n            const currentOverlayVisible = overlayVisible && showAnimateType === ShowAnimateEnum.None;\n            // 关闭过程中使用下拉保存的透明度\n            const currentOpacity = visible ? backdropOpacity : lastBackdropOpacity;\n\n            return (\n              <SlideWrap\n                className={classNames({ 'PhotoView-PhotoSlider__clean': !currentOverlayVisible }, className)}\n              >\n                <div\n                  className={classNames('PhotoView-PhotoSlider__Backdrop', maskClassName, {\n                    'PhotoView-PhotoSlider__fadeIn': showAnimateType === ShowAnimateEnum.In,\n                    'PhotoView-PhotoSlider__fadeOut': showAnimateType === ShowAnimateEnum.Out,\n                  })}\n                  style={{\n                    background: `rgba(0, 0, 0, ${currentOpacity})`,\n                  }}\n                  onAnimationEnd={onShowAnimateEnd}\n                />\n                {bannerVisible && (\n                  <div className=\"PhotoView-PhotoSlider__BannerWrap\">\n                    <div className=\"PhotoView-PhotoSlider__Counter\">\n                      {photoIndex + 1} / {imageLength}\n                    </div>\n                    <div className=\"PhotoView-PhotoSlider__BannerRight\">\n                      <CloseSVG\n                        className=\"PhotoView-PhotoSlider__Close\"\n                        onTouchEnd={isTouchDevice ? this.handleClose : undefined}\n                        onClick={isTouchDevice ? undefined : this.handleClose}\n                      />\n                    </div>\n                  </div>\n                )}\n                {images\n                  .slice(\n                    // 加载相邻三张\n                    Math.max(photoIndex - 1, 0),\n                    Math.min(photoIndex + 2, imageLength + 1),\n                  )\n                  .map((item: dataType, index) => {\n                    // 截取之前的索引位置\n                    const realIndex = photoIndex === 0 ? photoIndex + index : photoIndex - 1 + index;\n                    return (\n                      <PhotoView\n                        key={item.key || realIndex}\n                        src={item.src}\n                        onReachMove={this.handleReachMove}\n                        onReachUp={this.handleReachUp}\n                        onPhotoTap={this.handlePhotoTap}\n                        onMaskTap={this.handlePhotoMaskTap}\n                        viewClassName={viewClassName}\n                        className={imageClassName}\n                        style={{\n                          left: `${(innerWidth + horizontalOffset) * realIndex}px`,\n                          WebkitTransform: transform,\n                          transform,\n                          transition:\n                            touched || !shouldTransition\n                              ? undefined\n                              : 'transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1)',\n                        }}\n                        loadingElement={loadingElement}\n                        brokenElement={brokenElement}\n                        onPhotoResize={this.handleResize}\n                        isActive={photoIndex === realIndex}\n                        showAnimateType={showAnimateType}\n                        originRect={originRect}\n                      />\n                    );\n                  })}\n                {!isTouchDevice && bannerVisible && (\n                  <>\n                    {photoIndex !== 0 && (\n                      <div className=\"PhotoView-PhotoSlider__ArrowLeft\" onClick={() => this.handlePrevious(false)}>\n                        <ArrowLeft />\n                      </div>\n                    )}\n                    {photoIndex + 1 < imageLength && (\n                      <div className=\"PhotoView-PhotoSlider__ArrowRight\" onClick={() => this.handleNext(false)}>\n                        <ArrowRight />\n                      </div>\n                    )}\n                  </>\n                )}\n                {Boolean(introVisible && overlayIntro) && (\n                  <div className=\"PhotoView-PhotoSlider__FooterWrap\">{overlayIntro}</div>\n                )}\n                {overlayRender &&\n                  overlayRender({\n                    images,\n                    index: photoIndex,\n                    visible,\n                    onClose: this.handleClose,\n                    onIndexChange: this.handleIndexChange,\n                    overlayVisible: currentOverlayVisible,\n                  })}\n              </SlideWrap>\n            );\n          }\n          return null;\n        }}\n      </VisibleAnimationHandle>\n    );\n  }\n}\n","import React from 'react';\nimport PhotoContext, { onShowType, addItemType, removeItemType } from './photo-context';\nimport PhotoSlider from './PhotoSlider';\nimport { dataType, IPhotoProviderBase } from './types';\n\nexport interface IPhotoProvider extends IPhotoProviderBase {\n  children: React.ReactNode;\n}\n\ntype PhotoProviderState = {\n  images: dataType[];\n  visible: boolean;\n  index: number;\n  onShow: onShowType;\n  addItem: addItemType;\n  removeItem: removeItemType;\n};\n\nexport default class PhotoProvider extends React.Component<IPhotoProvider, PhotoProviderState> {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      images: [],\n      visible: false,\n      index: 0,\n      addItem: this.handleAddItem,\n      removeItem: this.handleRemoveItem,\n      onShow: this.handleShow,\n    };\n  }\n\n  handleAddItem: addItemType = imageItem => {\n    this.setState(prev => ({\n      images: prev.images.concat(imageItem),\n    }));\n  };\n\n  handleRemoveItem = (key: string) => {\n    this.setState(({ images, index }) => {\n      const nextImages = images.filter(item => item.key !== key);\n      const nextEndIndex = nextImages.length - 1;\n      return {\n        images: nextImages,\n        index: Math.min(nextEndIndex, index),\n      };\n    });\n  };\n\n  handleShow = (key: string) => {\n    const { images } = this.state;\n    this.setState({\n      visible: true,\n      index: images.findIndex(item => item.key === key),\n    });\n  };\n\n  handleClose = () => {\n    this.setState({\n      visible: false,\n    });\n  };\n\n  handleIndexChange = (index: number) => {\n    this.setState({\n      index,\n    });\n  };\n\n  render() {\n    const { children, ...restProps } = this.props;\n    const { images, visible, index } = this.state;\n\n    return (\n      <PhotoContext.Provider value={this.state}>\n        {children}\n        <PhotoSlider\n          images={images}\n          visible={visible}\n          index={index}\n          onIndexChange={this.handleIndexChange}\n          onClose={this.handleClose}\n          {...restProps}\n        />\n      </PhotoContext.Provider>\n    );\n  }\n}\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to generate unique IDs. */\nvar idCounter = 0;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {string} [prefix=''] The value to prefix the ID with.\n * @returns {string} Returns the unique ID.\n * @example\n *\n * _.uniqueId('contact_');\n * // => 'contact_104'\n *\n * _.uniqueId();\n * // => '105'\n */\nfunction uniqueId(prefix) {\n  var id = ++idCounter;\n  return toString(prefix) + id;\n}\n\nmodule.exports = uniqueId;\n","import React from 'react';\nimport uniqueId from 'lodash.uniqueid';\nimport isTouchDevice from './utils/isTouchDevice';\nimport PhotoContext, { PhotoContextType } from './photo-context';\n\nexport interface IPhotoConsumer {\n  src: string;\n  intro?: React.ReactNode;\n  children?: React.ReactElement<any>;\n}\n\nconst PhotoConsumer: React.FC<IPhotoConsumer> = ({ src, intro, children }) => {\n  const photoContext = React.useContext<PhotoContextType>(PhotoContext);\n  const key = React.useMemo<string>(() => uniqueId(), [] as readonly []);\n  const [position, updatePosition] = React.useState<{\n    clientX: number | undefined;\n    clientY: number | undefined;\n  }>({\n    clientX: undefined,\n    clientY: undefined,\n  });\n  const photoTriggerRef = React.useRef<HTMLElement | null>(null);\n\n  React.useEffect(() => {\n    photoContext.addItem({\n      key,\n      src,\n      originRef: photoTriggerRef.current,\n      intro,\n    });\n    return () => {\n      photoContext.removeItem(key);\n    };\n  }, [] as readonly []);\n\n  function handleTouchStart(e) {\n    const { clientX, clientY } = e.touches[0];\n    updatePosition({\n      clientX,\n      clientY,\n    });\n    if (children) {\n      const { onTouchStart } = children.props;\n      if (onTouchStart) {\n        onTouchStart(e);\n      }\n    }\n  }\n\n  function handleTouchEnd(e) {\n    const { clientX, clientY } = e.changedTouches[0];\n    if (position.clientX === clientX && position.clientY === clientY) {\n      photoContext.onShow(key);\n    }\n    if (children) {\n      const { onTouchEnd } = children.props;\n      if (onTouchEnd) {\n        onTouchEnd(e);\n      }\n    }\n  }\n\n  function handleClick(e) {\n    photoContext.onShow(key);\n    if (children) {\n      const { onClick } = children.props;\n      if (onClick) {\n        onClick(e);\n      }\n    }\n  }\n\n  if (children) {\n    return React.Children.only(\n      React.cloneElement(\n        children,\n        isTouchDevice\n          ? {\n              onTouchStart: handleTouchStart,\n              onTouchEnd: handleTouchEnd,\n              ref: photoTriggerRef,\n            }\n          : { onClick: handleClick, ref: photoTriggerRef },\n      ),\n    );\n  }\n  return null;\n};\n\nexport default PhotoConsumer;\n"]},"metadata":{},"sourceType":"module"}